<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>×”×–×× ×ª ××›×•×œ×”- ×¦'××˜×‘×•×˜ ×œ×¤×™× ×•×™ ×¤×¡×•×œ×ª ×‘× ×™×™×Ÿ</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.min.js"></script>
    <style>
        :root {
            --primary: #2e8b57; /* ×™×¨×•×§ ×›×”×” - ×¦×‘×¢ ××§×•×œ×•×’×™ */
            --primary-dark: #1a5e3a;
            --accent: #f39c12; /* ×›×ª×•× - ×¦×‘×¢ ××™×—×–×•×¨ */
            --light: #f8f9fa;
            --dark: #343a40;
            --success: #28a745;
            --info: #17a2b8;
            --warning: #ffc107;
            --danger: #dc3545;
            --gray: #6c757d;
            --chat-bg: #e5ddd5;
            --bot-bubble: #ffffff;
            --user-bubble: #dcf8c6;
            --placement-color: #4CAF50; /* ×™×¨×•×§ ×œ×”×¦×‘×” */
            --replacement-color: #FFC107; /* ×¦×”×•×‘ ×œ×”×—×œ×¤×” */
            --removal-color: #F44336; /* ××“×•× ×œ×”×•×¦××” */
            --new-order-color: #9C27B0; /* ×¡×’×•×œ ×œ×”×–×× ×” ×—×“×©×” */
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
        }
        
        body {
            background-color: #f0f2f5;
            color: var(--dark);
            line-height: 1.6;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        .header {
            background: linear-gradient(135deg, var(--primary-dark), var(--primary));
            color: white;
            padding: 15px 20px;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            position: relative;
            z-index: 100;
            animation: gradientBG 15s ease infinite;
            background-size: 400% 400%;
        }
        
        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .header h1 {
            font-size: 1.4rem;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .header p {
            font-size: 0.85rem;
            opacity: 0.9;
        }
        
        .chat-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            background-color: var(--chat-bg);
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%239C92AC' fill-opacity='0.05' fill-rule='evenodd'/%3E%3C/svg%3E");
            position: relative;
        }
        
        .chat-header {
            background-color: var(--primary);
            color: white;
            padding: 12px 15px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            z-index: 10;
        }
        
        .chat-header .logo {
            display: flex;
            align-items: center;
            font-weight: 500;
        }
        
        .chat-header .logo img {
            height: 26px;
            margin-left: 10px;
        }
        
        .chat-header .status {
            display: flex;
            align-items: center;
            font-size: 0.8rem;
        }
        
        .chat-header .status-dot {
            width: 8px;
            height: 8px;
            background-color: #4caf50;
            border-radius: 50%;
            margin-left: 5px;
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.2); opacity: 0.7; }
            100% { transform: scale(1); opacity: 1; }
        }
        
        .chat-messages {
            flex: 1;
            padding: 15px 10px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 8px;
            scroll-behavior: smooth;
        }
        
        .message {
            max-width: 85%;
            padding: 10px 14px;
            border-radius: 18px;
            position: relative;
            animation: fadeIn 0.3s ease-out;
            box-shadow: 0 1px 0.5px rgba(0, 0, 0, 0.1);
            line-height: 1.5;
            font-size: 0.95rem;
            word-break: break-word;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .bot-message {
            align-self: flex-start;
            background-color: var(--bot-bubble);
            color: var(--dark);
            border-bottom-left-radius: 4px;
            margin-right: 30px;
            animation: botMessageIn 0.5s ease-out;
        }
        
        @keyframes botMessageIn {
            0% { opacity: 0; transform: translateY(10px) scale(0.9); }
            70% { opacity: 1; transform: translateY(-2px) scale(1.01); }
            100% { opacity: 1; transform: translateY(0) scale(1); }
        }
        
        .user-message {
            align-self: flex-end;
            background-color: var(--user-bubble);
            color: var(--dark);
            border-bottom-right-radius: 4px;
            margin-left: 30px;
            animation: userMessageIn 0.5s ease-out;
        }
        
        @keyframes userMessageIn {
            0% { opacity: 0; transform: translateX(10px); }
            70% { opacity: 1; transform: translateX(-2px); }
            100% { opacity: 1; transform: translateX(0); }
        }
        
        .info-message {
            align-self: center;
            background-color: rgba(255, 255, 255, 0.8);
            color: var(--gray);
            border-radius: 8px;
            text-align: center;
            font-size: 0.8rem;
            padding: 8px 12px;
            margin: 5px 0;
            max-width: 70%;
        }
        
        .calculation-message {
            background-color: rgba(255, 255, 255, 0.9);
            border-left: 4px solid var(--primary);
            border-radius: 8px;
            padding: 12px 15px;
            margin: 5px 0;
            max-width: 90%;
        }
        
        .calculation-message h4 {
            margin-bottom: 8px;
            color: var(--primary);
            font-size: 1rem;
        }
        
        .calculation-result {
            font-weight: bold;
            color: var(--success);
            margin-top: 8px;
            font-size: 1rem;
        }
        
        .chat-input-area {
            display: flex;
            padding: 10px;
            background-color: #f0f2f5;
            border-top: 1px solid #e0e0e0;
            position: relative;
        }
        
        .chat-input {
            flex: 1;
            padding: 12px 15px;
            border: none;
            border-radius: 21px;
            outline: none;
            font-size: 0.95rem;
            transition: all 0.3s;
            background-color: white;
            box-shadow: 0 1px 1px rgba(0, 0, 0, 0.1);
            min-height: 42px;
            max-height: 120px;
            resize: none;
            overflow-y: auto;
        }
        
        .chat-input:focus {
            box-shadow: 0 0 0 2px var(--primary);
        }
        
        .send-button {
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 50%;
            width: 42px;
            height: 42px;
            margin-right: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
            flex-shrink: 0;
        }
        
        .send-button:hover {
            background-color: var(--primary-dark);
            transform: scale(1.05);
        }
        
        .send-button:active {
            transform: scale(0.95);
        }
        
        .quick-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            padding: 10px;
            background-color: #f0f2f5;
            border-top: 1px solid #e0e0e0;
            transition: all 0.3s;
        }
        
        .quick-action {
            background-color: white;
            border: 1px solid #ddd;
            border-radius: 20px;
            padding: 8px 14px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
            position: relative;
            overflow: hidden;
            z-index: 1;
        }
        
        .quick-action:before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 0;
            height: 100%;
            background-color: var(--primary);
            transition: all 0.3s;
            z-index: -1;
            border-radius: 20px;
        }
        
        .quick-action:hover {
            color: white;
            border-color: var(--primary);
            transform: translateY(-3px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .quick-action:hover:before {
            width: 100%;
        }
        
        .quick-action.placement-action {
            border-color: var(--placement-color);
        }
        
        .quick-action.placement-action:before {
            background-color: var(--placement-color);
        }
        
        .quick-action.replacement-action {
            border-color: var(--replacement-color);
        }
        
        .quick-action.replacement-action:before {
            background-color: var(--replacement-color);
        }
        
        .quick-action.removal-action {
            border-color: var(--removal-color);
        }
        
        .quick-action.removal-action:before {
            background-color: var(--removal-color);
        }
        
        .quick-action.new-order-action {
            border-color: var(--new-order-color);
            animation: pulsePurple 2s infinite;
        }
        
        .quick-action.new-order-action:before {
            background-color: var(--new-order-color);
        }
        
        @keyframes pulsePurple {
            0% { box-shadow: 0 0 0 0 rgba(156, 39, 176, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(156, 39, 176, 0); }
            100% { box-shadow: 0 0 0 0 rgba(156, 39, 176, 0); }
        }
        
        .order-form {
            display: none;
            padding: 15px;
            background-color: white;
            border-top: 1px solid #e0e0e0;
            animation: slideUp 0.3s ease-out;
            max-height: 60vh;
            overflow-y: auto;
        }
        
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            font-size: 0.9rem;
            color: var(--dark);
        }
        
        .form-group input, 
        .form-group textarea, 
        .form-group select {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 0.95rem;
            transition: all 0.3s;
        }
        
        .form-group input:focus, 
        .form-group textarea:focus, 
        .form-group select:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(46, 139, 87, 0.2);
        }
        
        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 15px;
            padding-top: 10px;
            border-top: 1px solid #eee;
        }
        
        .btn {
            padding: 10px 18px;
            border: none;
            border-radius: 6px;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 500;
        }
        
        .btn-primary {
            background-color: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: var(--primary-dark);
        }
        
        .btn-secondary {
            background-color: var(--gray);
            color: white;
        }
        
        .btn-secondary:hover {
            background-color: #5a6268;
        }
        
        .btn-success {
            background-color: var(--success);
            color: white;
        }
        
        .btn-success:hover {
            background-color: #218838;
        }
        
        .btn-outline {
            background-color: transparent;
            border: 1px solid var(--primary);
            color: var(--primary);
        }
        
        .btn-outline:hover {
            background-color: rgba(46, 139, 87, 0.1);
        }
        
        .material-table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
            font-size: 0.85rem;
            background-color: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .material-table th, .material-table td {
            padding: 10px 12px;
            text-align: right;
            border-bottom: 1px solid #eee;
        }
        
        .material-table th {
            background-color: var(--primary);
            color: white;
            font-weight: 500;
        }
        
        .material-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        
        .material-table tr:hover {
            background-color: #f1f1f1;
        }
        
        .branches {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-top: 12px;
        }
        
        .branch-card {
            flex: 1;
            min-width: 250px;
            background-color: white;
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            overflow: hidden;
            z-index: 1;
        }
        
        .branch-card:before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 0;
            background-color: rgba(46, 139, 87, 0.05);
            transition: all 0.4s ease;
            z-index: -1;
        }
        
        .branch-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
        }
        
        .branch-card:hover:before {
            height: 100%;
        }
        
        .branch-card.placement-card {
            border-right: 4px solid var(--placement-color);
        }
        
        .branch-card.replacement-card {
            border-right: 4px solid var(--replacement-color);
        }
        
        .branch-card.removal-card {
            border-right: 4px solid var(--removal-color);
        }
        
        .rental-info {
            position: relative;
            width: 100%;
        }
        
        .rental-popup {
            display: none;
            position: absolute;
            top: 100%;
            right: 0;
            width: 100%;
            background-color: #fff9e6;
            border: 1px solid #ffd700;
            border-radius: 5px;
            padding: 10px;
            margin-top: 5px;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);
            z-index: 10;
            animation: popupFadeIn 0.3s ease-out;
            color: #333;
            font-size: 0.9rem;
        }
        
        @keyframes popupFadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .rental-popup i {
            color: #ffd700;
            margin-left: 5px;
        }
        
        .rental-popup strong {
            color: var(--primary);
            font-weight: bold;
        }
        
        .branch-card h4 {
            color: var(--primary);
            margin-bottom: 6px;
            display: flex;
            align-items: center;
            font-size: 1rem;
        }
        
        .branch-card h4 i {
            margin-left: 8px;
            font-size: 0.9rem;
        }
        
        .branch-card p {
            margin-bottom: 6px;
            font-size: 0.85rem;
            color: var(--gray);
        }
        
        .branch-card .phone {
            color: var(--primary);
            font-weight: 500;
            font-size: 0.95rem;
        }
        
        .motivation-message {
            background-color: #fff8e1;
            border-left: 4px solid var(--warning);
            padding: 12px;
            margin: 8px 0;
            border-radius: 0 8px 8px 0;
            font-style: italic;
            max-width: 90%;
        }
        
        .joke-message {
            background-color: #e8f5e9;
            border-left: 4px solid var(--success);
            padding: 12px;
            margin: 8px 0;
            border-radius: 0 8px 8px 0;
            max-width: 90%;
        }
        
        .joke-message .punchline {
            font-weight: bold;
            margin-top: 8px;
            color: var(--success);
        }
        
        .typing-indicator {
            display: flex;
            padding: 10px 14px;
            align-self: flex-start;
            background-color: var(--bot-bubble);
            border-radius: 18px;
            margin-bottom: 8px;
            box-shadow: 0 1px 0.5px rgba(0, 0, 0, 0.1);
        }
        
        .typing-dot {
            width: 8px;
            height: 8px;
            background-color: #aaa;
            border-radius: 50%;
            margin: 0 3px;
            animation: bounce 1.4s infinite ease-in-out;
        }
        
        .typing-dot:nth-child(1) {
            animation-delay: 0s;
        }
        
        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }
        
        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }
        
        @keyframes bounce {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-5px); }
        }
        
        .whatsapp-button {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            background-color: #25D366;
            color: white;
            padding: 10px 16px;
            border-radius: 25px;
            text-decoration: none;
            font-weight: 500;
            margin-top: 10px;
            transition: all 0.3s;
            font-size: 0.9rem;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        
        .whatsapp-button:hover {
            background-color: #128C7E;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }
        
        .whatsapp-button i {
            margin-left: 8px;
            font-size: 1.1rem;
        }
        
        .order-summary {
            background-color: white;
            border-radius: 8px;
            padding: 12px;
            margin: 10px 0;
            border-left: 4px solid var(--accent);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            max-width: 90%;
        }
        
        .order-summary h4 {
            color: var(--accent);
            margin-bottom: 8px;
            font-size: 1.1rem;
        }
        
        .order-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #eee;
            font-size: 0.9rem;
        }
        
        .order-item:last-child {
            border-bottom: none;
        }
        
        .order-item .label {
            font-weight: 500;
            color: var(--gray);
        }
        
        .order-item .value {
            color: var(--dark);
            text-align: left;
            margin-right: 10px;
        }
        
        .order-total {
            font-weight: bold;
            margin-top: 8px;
            color: var(--primary);
            font-size: 1rem;
        }
        
        .user-name {
            font-weight: bold;
            color: var(--primary);
        }
        
        .user-name.female::after {
            content: " ğŸ‘©";
        }
        
        .user-name.male::after {
            content: " ğŸ‘¨";
        }
        
        .material-search-container {
            position: relative;
            margin-bottom: 15px;
        }
        
        .material-search-input {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 0.95rem;
        }
        
        .material-search-results {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background-color: white;
            border: 1px solid #ddd;
            border-radius: 0 0 6px 6px;
            max-height: 200px;
            overflow-y: auto;
            z-index: 100;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            display: none;
        }
        
        .material-search-result {
            padding: 8px 12px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .material-search-result:hover {
            background-color: #f5f5f5;
        }
        
        .quantity-input {
            display: flex;
            align-items: center;
            margin-top: 5px;
        }
        
        .quantity-input input {
            width: 60px;
            padding: 6px;
            border: 1px solid #ddd;
            border-radius: 4px;
            text-align: center;
            margin-left: 8px;
        }
        
        .order-items-list {
            margin-top: 15px;
            border: 1px solid #eee;
            border-radius: 6px;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .order-item-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 12px;
            border-bottom: 1px solid #eee;
            align-items: center;
        }
        
        .order-item-row:last-child {
            border-bottom: none;
        }
        
        .order-item-name {
            flex: 1;
        }
        
        .order-item-quantity {
            width: 50px;
            text-align: center;
        }
        
        .remove-item {
            color: var(--danger);
            cursor: pointer;
            margin-left: 10px;
        }
        
        .phone-input-container {
            display: flex;
            align-items: center;
        }
        
        .phone-input-container select {
            width: 80px;
            margin-left: 8px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
        }
        
        .phone-input-container input {
            flex: 1;
        }
        
        /* Animation for new message */
        .new-message {
            animation: highlight 1.5s ease-out;
        }
        
        @keyframes highlight {
            0% { background-color: rgba(46, 139, 87, 0.1); }
            100% { background-color: transparent; }
        }
        
        /* Emoji typing animation */
        @keyframes emojiPop {
            0% { transform: scale(1); }
            50% { transform: scale(1.3); }
            100% { transform: scale(1); }
        }
        
        .emoji {
            display: inline-block;
            animation: emojiPop 0.5s ease;
        }
        
        /* Form tabs */
        .form-tabs {
            display: flex;
            border-bottom: 1px solid #ddd;
            margin-bottom: 15px;
        }
        
        .form-tab {
            padding: 10px 15px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
            font-weight: 500;
            color: var(--gray);
        }
        
        .form-tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }
        
        .form-tab:hover:not(.active) {
            color: var(--dark);
            border-bottom-color: #ddd;
        }
        
        .form-tab-content {
            display: none;
        }
        
        .form-tab-content.active {
            display: block;
        }
        
        /* Material icons */
        .material-icon {
            margin-left: 8px;
            font-size: 0.9rem;
            animation: float 2s ease-in-out infinite;
        }
        
        @keyframes float {
            0% { transform: translateY(0); }
            50% { transform: translateY(-3px); }
            100% { transform: translateY(0); }
        }
        
        /* FAQ Section */
        .faq-container {
            margin-top: 15px;
        }
        
        .faq-item {
            background-color: white;
            border-radius: 8px;
            margin-bottom: 10px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .faq-question {
            padding: 12px 15px;
            background-color: #f8f9fa;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 500;
            transition: all 0.3s;
        }
        
        .faq-question:hover {
            background-color: #e9ecef;
        }
        
        .faq-question i {
            transition: transform 0.3s;
        }
        
        .faq-question.active i {
            transform: rotate(180deg);
        }
        
        .faq-answer {
            padding: 0 15px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out, padding 0.3s ease;
        }
        
        .faq-answer.active {
            padding: 15px;
            max-height: 500px;
        }
        
        /* Share buttons */
        .share-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .share-button {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 8px 12px;
            border-radius: 20px;
            color: white;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .share-button.whatsapp {
            background-color: #25D366;
        }
        
        .share-button.facebook {
            background-color: #3b5998;
        }
        
        .share-button.email {
            background-color: #d44638;
        }
        
        .share-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .share-button i {
            margin-left: 5px;
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.2rem;
            }
            
            .message {
                max-width: 90%;
                font-size: 0.9rem;
                padding: 8px 12px;
            }
            
            .branch-card {
                min-width: 100%;
            }
            
            .chat-input {
                padding: 10px 12px;
                font-size: 0.9rem;
            }
            
            .quick-action {
                padding: 6px 12px;
                font-size: 0.8rem;
            }
            
            .form-tabs {
                flex-wrap: wrap;
            }
            
            .form-tab {
                flex: 1;
                text-align: center;
                padding: 8px 5px;
                font-size: 0.85rem;
            }
        }
        
        @media (max-width: 480px) {
            .header h1 {
                font-size: 1.1rem;
            }
            
            .header p {
                font-size: 0.8rem;
            }
            
            .message {
                max-width: 95%;
            }
            
            .form-actions {
                flex-direction: column;
                gap: 8px;
            }
            
            .btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1><i class="fas fa-recycle"></i> ×”×–×× ×ª ××›×•×œ×” - ×¦'××˜×‘×•×˜ ××ª×§×“×</h1>
        <p>×”×‘×™× ×” ×”××œ××›×•×ª×™×ª ×©×œ ××§×•-×¤×™× ×•×™ ×¤×¡×•×œ×ª ×‘× ×™×™×Ÿ - ×›××Ÿ ×›×“×™ ×œ×¡×™×™×¢ ×‘×›×œ ×©××œ×”!</p>
    </div>
    
    <div class="chat-container">
        <div class="chat-header">
            <div class="logo">
                <span>××§×•-×¤×™× ×•×™ ×¤×¡×•×œ×ª ×‘× ×™×™×Ÿ</span>
            </div>
            <div class="status">
                <span>××§×•×•×Ÿ</span>
                <div class="status-dot"></div>
            </div>
        </div>
        
        <div class="chat-messages" id="chat-messages">
            <!-- Messages will be inserted here by JavaScript -->
        </div>
        
        <div class="quick-actions" id="quick-actions">
            <div class="quick-action placement-action" onclick="sendQuickMessage('××” ×”××—×™×¨ ×œ×”×¦×‘×ª ××›×•×œ×”?')"><i class="fas fa-truck-loading"></i> ××—×™×¨×™ ×”×¦×‘×ª ××›×•×œ×•×ª</div>
            <div class="quick-action" onclick="sendQuickMessage('××™×œ×• ×’×“×œ×™× ×©×œ ××›×•×œ×•×ª ×™×©?')"><i class="fas fa-ruler-combined"></i> ×’×“×œ×™ ××›×•×œ×•×ª</div>
            <div class="quick-action" onclick="sendQuickMessage('××” ×”×ª×§× ×•×ª ×œ×”×¦×‘×ª ××›×•×œ×”?')"><i class="fas fa-clipboard-list"></i> ×ª×§× ×•×ª ×”×¦×‘×”</div>
            <div class="quick-action replacement-action" onclick="sendQuickMessage('××” ×”××—×™×¨ ×œ×”×—×œ×¤×ª ××›×•×œ×”?')"><i class="fas fa-exchange-alt"></i> ×”×—×œ×¤×ª ××›×•×œ×”</div>
            <div class="quick-action removal-action" onclick="sendQuickMessage('××™×š ××•×¦×™××™× ××›×•×œ×”?')"><i class="fas fa-trash-restore"></i> ×”×•×¦××ª ××›×•×œ×”</div>
            <div class="quick-action new-order-action" onclick="showOrderForm()"><i class="fas fa-shopping-cart"></i> ×”×–×× ×” ×—×“×©×”</div>
        </div>
        
        <div class="order-form" id="order-form">
            <h4 style="margin-bottom: 15px; color: var(--primary);">×”×–×× ×” ×—×“×©×”</h4>
            
            <div class="form-tabs">
                <div class="form-tab active" onclick="switchTab('customer-info')">×¤×¨×˜×™ ×œ×§×•×—</div>
                <div class="form-tab" onclick="switchTab('container')">××›×•×œ×”</div>
                <div class="form-tab" onclick="switchTab('location')">××™×§×•×</div>
                <div class="form-tab" onclick="switchTab('services')">×©×™×¨×•×ª×™×</div>
            </div>
            
            <div id="customer-info" class="form-tab-content active">
                <div class="form-group">
                    <label for="order-name">×©× ××™×© ×§×©×¨:</label>
                    <input type="text" id="order-name" placeholder="×”×–×Ÿ ××ª ×©××š ×”××œ×">
                </div>
                
                <div class="form-group">
                    <label for="order-phone">×˜×œ×¤×•×Ÿ:</label>
                    <div class="phone-input-container">
                        <input type="tel" id="order-phone" placeholder="×”×–×Ÿ ××¡×¤×¨ ×˜×œ×¤×•×Ÿ">
                        <select id="phone-prefix">
                            <option value="972">×™×©×¨××œ (+972)</option>
                            <option value="1">××¨×”"×‘ (+1)</option>
                            <option value="44">×‘×¨×™×˜× ×™×” (+44)</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="order-address">×›×ª×•×‘×ª ××¡×¤×§×”:</label>
                    <input type="text" id="order-address" placeholder="×¨×—×•×‘, ××¡', ×¢×™×¨">
                </div>
                
                <div class="form-group">
                    <label for="send-to-phone">×©×œ×— ×”×¢×ª×§ ×œ×˜×œ×¤×•×Ÿ:</label>
                    <input type="tel" id="send-to-phone" placeholder="××•×¤×¦×™×•× ×œ×™ - ××¡×¤×¨ ×œ×§×‘×œ×ª ×”×¢×ª×§">
                </div>
            </div>
            
            <div id="container" class="form-tab-content">
                <div class="form-group">
                    <label for="container-size">×’×•×“×œ ××›×•×œ×”:</label>
                    <select id="container-size">
                        <option value="8">××›×•×œ×” 8 ×§×•×‘</option>
                        <option value="16">××›×•×œ×” 16 ×§×•×‘</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="container-date">×ª××¨×™×š ×”×¦×‘×” ××‘×•×§×©:</label>
                    <input type="date" id="container-date" onchange="updateRentalEndDate()">
                </div>
                
                <div class="form-group">
                    <label for="container-duration">××©×š ×–××Ÿ ××©×•×¢×¨ (×™××™×):</label>
                    <div class="rental-info">
                        <input type="number" id="container-duration" min="1" value="10" onchange="updateRentalEndDate()">
                        <div id="rental-end-date" class="rental-popup">
                            <i class="fas fa-info-circle"></i> <span>×©×›×™×¨×•×ª ×”××›×•×œ×” ×ª×¡×ª×™×™× ×‘×ª××¨×™×š: <strong id="end-date-display"></strong></span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="location" class="form-tab-content">
                <div class="form-group">
                    <label for="city-select">×¢×™×¨:</label>
                    <select id="city-select" onchange="updateCityRegulations()">
                        <option value="">×‘×—×¨ ×¢×™×¨</option>
                        <optgroup label="××–×•×¨ ×”××¨×›×– ×•×”×©×¨×•×Ÿ">
                            <option value="tel-aviv">×ª×œ ××‘×™×‘</option>
                            <option value="herzliya">×”×¨×¦×œ×™×”</option>
                            <option value="raanana">×¨×¢× × ×”</option>
                            <option value="kfar-saba">×›×¤×¨ ×¡×‘×</option>
                            <option value="netanya">× ×ª× ×™×”</option>
                            <option value="ramat-gan">×¨××ª ×’×Ÿ</option>
                            <option value="ramat-hasharon">×¨××ª ×”×©×¨×•×Ÿ</option>
                            <option value="petah-tikva">×¤×ª×— ×ª×§×•×•×”</option>
                            <option value="rishon">×¨××©×•×Ÿ ×œ×¦×™×•×Ÿ</option>
                            <option value="modiin">××•×“×™×¢×™×Ÿ</option>
                        </optgroup>
                        <optgroup label="××–×•×¨×™× × ×•×¡×¤×™×">
                            <option value="jerusalem">×™×¨×•×©×œ×™×</option>
                            <option value="haifa">×—×™×¤×”</option>
                            <option value="other">××—×¨</option>
                        </optgroup>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="location-type">×¡×•×’ ××™×§×•×:</label>
                    <select id="location-type">
                        <option value="private">×©×˜×— ×¤×¨×˜×™</option>
                        <option value="public">×©×˜×— ×¦×™×‘×•×¨×™ (×“×•×¨×© ×”×™×ª×¨)</option>
                        <option value="parking">×—× ×™×” ×¦×™×‘×•×¨×™×ª (×“×•×¨×© ×”×™×ª×¨)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="location-notes">×”×¢×¨×•×ª ×œ××™×§×•×:</label>
                    <textarea id="location-notes" placeholder="×¤×¨×˜×™× × ×•×¡×¤×™× ×œ×’×‘×™ ××™×§×•× ×”××›×•×œ×”"></textarea>
                </div>
                
                <div id="city-regulations" style="display: none; margin-top: 15px; padding: 10px; background-color: #f8f9fa; border-radius: 6px; border-right: 3px solid var(--primary);">
                    <h5 style="color: var(--primary); margin-bottom: 8px;">×ª×§× ×•×ª ×”×¢×™×¨×™×™×”:</h5>
                    <div id="regulations-content">
                        <!-- ×ª×§× ×•×ª ×”×¢×™×¨ ×™×•×¦×’×• ×›××Ÿ -->
                    </div>
                    <div id="permit-link" style="margin-top: 10px;">
                        <!-- ×§×™×©×•×¨ ×œ×”×™×ª×¨ ×™×•×¦×’ ×›××Ÿ -->
                    </div>
                </div>
            </div>
            
            <div id="services" class="form-tab-content">
                <div class="form-group">
                    <label>×¡×•×’ ×©×™×¨×•×ª:</label>
                    <div class="branches" style="margin-top: 10px;">
                        <div class="branch-card placement-card" onclick="selectService('placement')">
                            <h4><i class="fas fa-truck-loading material-icon"></i> ×”×¦×‘×ª ××›×•×œ×”</h4>
                            <p>×”×¦×‘×ª ××›×•×œ×” ×—×“×©×” ×‘××ª×¨</p>
                            <p class="phone">1200 â‚ª + ××¢"×</p>
                        </div>
                        <div class="branch-card replacement-card" onclick="selectService('replacement')">
                            <h4><i class="fas fa-exchange-alt material-icon"></i> ×”×—×œ×¤×ª ××›×•×œ×”</h4>
                            <p>×”×—×œ×¤×ª ××›×•×œ×” ××œ××” ×‘×¨×™×§×”</p>
                            <p class="phone">1200 â‚ª + ××¢"×</p>
                        </div>
                        <div class="branch-card removal-card" onclick="selectService('removal')">
                            <h4><i class="fas fa-trash-restore material-icon"></i> ×”×•×¦××ª ××›×•×œ×”</h4>
                            <p>×¤×™× ×•×™ ××›×•×œ×” ××”××ª×¨</p>
                            <p class="phone">×›×œ×•×œ ×‘××—×™×¨ ×”×”×¦×‘×”</p>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="service-notes">×”×¢×¨×•×ª × ×•×¡×¤×•×ª:</label>
                    <textarea id="service-notes" placeholder="×”×¢×¨×•×ª × ×•×¡×¤×•×ª ×œ×’×‘×™ ×”×©×™×¨×•×ª ×”××‘×•×§×©"></textarea>
                </div>
            </div>
            
            <div class="form-actions">
                <button class="btn btn-secondary" onclick="hideOrderForm()">×‘×™×˜×•×œ</button>
                <button class="btn btn-success" onclick="submitOrder()">×©×œ×— ×”×–×× ×”</button>
            </div>
        </div>
        
        <div class="chat-input-area">
            <textarea class="chat-input" id="user-input" placeholder="×”×§×œ×“ ××ª ×”×•×“×¢×ª×š ×›××Ÿ..." rows="1" onkeypress="handleKeyPress(event)"></textarea>
            <button class="send-button" onclick="sendMessage()">
                <i class="fas fa-paper-plane"></i>
            </button>
        </div>
    </div>
    
    <!-- 3D Container Model Popup -->
    <div id="container-model-popup" class="popup-overlay">
        <div class="popup-content">
            <div class="popup-header">
                <h3><i class="fas fa-cube"></i> ×”×“××™×™×ª ××›×•×œ×” ×ª×œ×ª ××™××“×™×ª</h3>
                <span class="close-popup" onclick="closeContainerModelPopup()">&times;</span>
            </div>
            <div class="popup-body">
                <div class="model-container">
                    <div id="container-model-viewer"></div>
                    <div class="model-controls">
                        <button id="model-8kub" class="btn btn-primary" onclick="switchContainerModel(8)">××›×•×œ×” 8 ×§×•×‘</button>
                        <button id="model-16kub" class="btn btn-secondary" onclick="switchContainerModel(16)">××›×•×œ×” 16 ×§×•×‘</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // User data
        let userName = '';
        let userGender = ''; // 'male' or 'female'
        let conversationState = 'greeting'; // Tracks where we are in the conversation
        let calculationData = {}; // Stores data during calculations
        let orderData = {}; // Stores order information
        let selectedService = ''; // Stores selected service type
        
        // City regulations database
        const cityRegulations = {
            'tel-aviv': {
                title: '×ª×§× ×•×ª ×”×¦×‘×ª ××›×•×œ×•×ª ×‘×ª×œ ××‘×™×‘',
                regulations: [
                    '×™×© ×œ×”×¦×™×‘ ××ª ×”××›×•×œ×” ×‘××§×•× ×©××™× ×• ××¤×¨×™×¢ ×œ×ª× ×•×¢×”',
                    '×™×© ×œ×¡××Ÿ ××ª ×”××›×•×œ×” ×‘×××¦×¢×•×ª ××—×–×™×¨×™ ××•×¨ ×‘×©×¢×•×ª ×”×—×©×™×›×”',
                    '××™×Ÿ ×œ×”×¦×™×‘ ××›×•×œ×” ×‘××¨×—×§ ×”×§×˜×Ÿ ×-20 ××˜×¨ ××¤×ª×— ×‘× ×™×™×Ÿ',
                    '×™×© ×œ×›×¡×•×ª ××ª ×”××›×•×œ×” ×‘×¡×•×£ ×™×•× ×”×¢×‘×•×“×”',
                    '××™×Ÿ ×œ×”×©××™×¨ ××›×•×œ×” ×‘×¨×—×•×‘ ××¢×œ 10 ×™××™× ×œ×œ× ××™×©×•×¨ ××™×•×—×“'
                ],
                permitLink: 'https://www.tel-aviv.gov.il/Forms'
            },
            'herzliya': {
                title: '×ª×§× ×•×ª ×”×¦×‘×ª ××›×•×œ×•×ª ×‘×”×¨×¦×œ×™×”',
                regulations: [
                    '×™×© ×œ×”×¦×™×‘ ××ª ×”××›×•×œ×” ×‘××§×•× ×©××™× ×• ××¤×¨×™×¢ ×œ×ª× ×•×¢×”',
                    '×™×© ×œ×¡××Ÿ ××ª ×”××›×•×œ×” ×‘×××¦×¢×•×ª ××—×–×™×¨×™ ××•×¨ ×‘×©×¢×•×ª ×”×—×©×™×›×”',
                    '×™×© ×œ×§×‘×œ ××™×©×•×¨ ××”×¢×™×¨×™×™×” ×œ×”×¦×‘×ª ××›×•×œ×” ×‘×©×˜×— ×¦×™×‘×•×¨×™',
                    '××™×Ÿ ×œ×”×©××™×¨ ××›×•×œ×” ×‘×¨×—×•×‘ ××¢×œ 7 ×™××™× ×œ×œ× ××™×©×•×¨ ××™×•×—×“',
                    '×™×© ×œ×•×•×“× ×©×”××›×•×œ×” ××™× ×” ×—×•×¡××ª ×’×™×©×” ×œ×—× ×™×•×ª ××• ××“×¨×›×•×ª'
                ],
                permitLink: 'https://www.herzliya.muni.il'
            },
            'raanana': {
                title: '×ª×§× ×•×ª ×”×¦×‘×ª ××›×•×œ×•×ª ×‘×¨×¢× × ×”',
                regulations: [
                    '×™×© ×œ×”×¦×™×‘ ××ª ×”××›×•×œ×” ×‘××§×•× ×©××™× ×• ××¤×¨×™×¢ ×œ×ª× ×•×¢×”',
                    '×™×© ×œ×¡××Ÿ ××ª ×”××›×•×œ×” ×‘×××¦×¢×•×ª ××—×–×™×¨×™ ××•×¨ ×‘×©×¢×•×ª ×”×—×©×™×›×”',
                    '×™×© ×œ×§×‘×œ ××™×©×•×¨ ××”×¢×™×¨×™×™×” ×œ×”×¦×‘×ª ××›×•×œ×” ×‘×©×˜×— ×¦×™×‘×•×¨×™',
                    '××™×Ÿ ×œ×”×©××™×¨ ××›×•×œ×” ×‘×¨×—×•×‘ ××¢×œ 7 ×™××™× ×œ×œ× ××™×©×•×¨ ××™×•×—×“',
                    '×™×© ×œ×›×¡×•×ª ××ª ×”××›×•×œ×” ×‘×¡×•×£ ×™×•× ×”×¢×‘×•×“×” ×œ×× ×™×¢×ª ××¤×’×¢×™×'
                ],
                permitLink: 'https://www.raanana.muni.il'
            },
            'kfar-saba': {
                title: '×ª×§× ×•×ª ×”×¦×‘×ª ××›×•×œ×•×ª ×‘×›×¤×¨ ×¡×‘×',
                regulations: [
                    '×™×© ×œ×”×¦×™×‘ ××ª ×”××›×•×œ×” ×‘××§×•× ×©××™× ×• ××¤×¨×™×¢ ×œ×ª× ×•×¢×”',
                    '×™×© ×œ×¡××Ÿ ××ª ×”××›×•×œ×” ×‘×××¦×¢×•×ª ××—×–×™×¨×™ ××•×¨ ×‘×©×¢×•×ª ×”×—×©×™×›×”',
                    '×™×© ×œ×§×‘×œ ××™×©×•×¨ ××”×¢×™×¨×™×™×” ×œ×”×¦×‘×ª ××›×•×œ×” ×‘×©×˜×— ×¦×™×‘×•×¨×™',
                    '××™×Ÿ ×œ×”×©××™×¨ ××›×•×œ×” ×‘×¨×—×•×‘ ××¢×œ 7 ×™××™× ×œ×œ× ××™×©×•×¨ ××™×•×—×“',
                    '×™×© ×œ×”×§×¤×™×“ ×¢×œ × ×™×§×™×•×Ÿ ×¡×‘×™×‘×ª ×”××›×•×œ×”'
                ],
                permitLink: 'https://www.kfar-saba.muni.il'
            },
            'netanya': {
                title: '×ª×§× ×•×ª ×”×¦×‘×ª ××›×•×œ×•×ª ×‘× ×ª× ×™×”',
                regulations: [
                    '×™×© ×œ×”×¦×™×‘ ××ª ×”××›×•×œ×” ×‘××§×•× ×©××™× ×• ××¤×¨×™×¢ ×œ×ª× ×•×¢×”',
                    '×™×© ×œ×¡××Ÿ ××ª ×”××›×•×œ×” ×‘×××¦×¢×•×ª ××—×–×™×¨×™ ××•×¨ ×‘×©×¢×•×ª ×”×—×©×™×›×”',
                    '×™×© ×œ×§×‘×œ ××™×©×•×¨ ××”×¢×™×¨×™×™×” ×œ×”×¦×‘×ª ××›×•×œ×” ×‘×©×˜×— ×¦×™×‘×•×¨×™',
                    '××™×Ÿ ×œ×”×©××™×¨ ××›×•×œ×” ×‘×¨×—×•×‘ ××¢×œ 10 ×™××™× ×œ×œ× ××™×©×•×¨ ××™×•×—×“',
                    '×™×© ×œ×•×•×“× ×©×”××›×•×œ×” ××™× ×” ××•×¦×‘×ª ×‘××–×•×¨×™ ×—×•×£ ××• ×ª×™×™×¨×•×ª'
                ],
                permitLink: 'https://www.netanya.muni.il'
            },
            'ramat-gan': {
                title: '×ª×§× ×•×ª ×”×¦×‘×ª ××›×•×œ×•×ª ×‘×¨××ª ×’×Ÿ',
                regulations: [
                    '×™×© ×œ×”×¦×™×‘ ××ª ×”××›×•×œ×” ×‘××§×•× ×©××™× ×• ××¤×¨×™×¢ ×œ×ª× ×•×¢×”',
                    '×™×© ×œ×¡××Ÿ ××ª ×”××›×•×œ×” ×‘×××¦×¢×•×ª ××—×–×™×¨×™ ××•×¨ ×‘×©×¢×•×ª ×”×—×©×™×›×”',
                    '×™×© ×œ×§×‘×œ ××™×©×•×¨ ××”×¢×™×¨×™×™×” ×œ×”×¦×‘×ª ××›×•×œ×” ×‘×©×˜×— ×¦×™×‘×•×¨×™',
                    '××™×Ÿ ×œ×”×©××™×¨ ××›×•×œ×” ×‘×¨×—×•×‘ ××¢×œ 7 ×™××™× ×œ×œ× ××™×©×•×¨ ××™×•×—×“',
                    '×™×© ×œ×›×¡×•×ª ××ª ×”××›×•×œ×” ×‘×¡×•×£ ×™×•× ×”×¢×‘×•×“×”'
                ],
                permitLink: 'https://www.ramat-gan.muni.il'
            },
            'ramat-hasharon': {
                title: '×ª×§× ×•×ª ×”×¦×‘×ª ××›×•×œ×•×ª ×‘×¨××ª ×”×©×¨×•×Ÿ',
                regulations: [
                    '×™×© ×œ×”×¦×™×‘ ××ª ×”××›×•×œ×” ×‘××§×•× ×©××™× ×• ××¤×¨×™×¢ ×œ×ª× ×•×¢×”',
                    '×™×© ×œ×¡××Ÿ ××ª ×”××›×•×œ×” ×‘×××¦×¢×•×ª ××—×–×™×¨×™ ××•×¨ ×‘×©×¢×•×ª ×”×—×©×™×›×”',
                    '×™×© ×œ×§×‘×œ ××™×©×•×¨ ××”×¢×™×¨×™×™×” ×œ×”×¦×‘×ª ××›×•×œ×” ×‘×©×˜×— ×¦×™×‘×•×¨×™',
                    '××™×Ÿ ×œ×”×©××™×¨ ××›×•×œ×” ×‘×¨×—×•×‘ ××¢×œ 7 ×™××™× ×œ×œ× ××™×©×•×¨ ××™×•×—×“',
                    '×™×© ×œ×”×§×¤×™×“ ×¢×œ × ×™×§×™×•×Ÿ ×¡×‘×™×‘×ª ×”××›×•×œ×”'
                ],
                permitLink: 'https://www.ramat-hasharon.muni.il'
            },
            'modiin': {
                title: '×ª×§× ×•×ª ×”×¦×‘×ª ××›×•×œ×•×ª ×‘××•×“×™×¢×™×Ÿ',
                regulations: [
                    '×™×© ×œ×”×¦×™×‘ ××ª ×”××›×•×œ×” ×‘××§×•× ×©××™× ×• ××¤×¨×™×¢ ×œ×ª× ×•×¢×”',
                    '×™×© ×œ×¡××Ÿ ××ª ×”××›×•×œ×” ×‘×××¦×¢×•×ª ××—×–×™×¨×™ ××•×¨ ×‘×©×¢×•×ª ×”×—×©×™×›×”',
                    '×™×© ×œ×§×‘×œ ××™×©×•×¨ ××”×¢×™×¨×™×™×” ×œ×”×¦×‘×ª ××›×•×œ×” ×‘×©×˜×— ×¦×™×‘×•×¨×™',
                    '××™×Ÿ ×œ×”×©××™×¨ ××›×•×œ×” ×‘×¨×—×•×‘ ××¢×œ 7 ×™××™× ×œ×œ× ××™×©×•×¨ ××™×•×—×“',
                    '×™×© ×œ×•×•×“× ×©×”××›×•×œ×” ××™× ×” ×—×•×¡××ª ×’×™×©×” ×œ×—× ×™×•×ª ××• ××“×¨×›×•×ª'
                ],
                permitLink: 'https://www.modiin.muni.il'
            },
            'jerusalem': {
                title: '×ª×§× ×•×ª ×”×¦×‘×ª ××›×•×œ×•×ª ×‘×™×¨×•×©×œ×™×',
                regulations: [
                    '×™×© ×œ×“×•×•×— ×œ××’×£ ××›×™×¤×” ×•×©×™×˜×•×¨ ×¢×™×¨×•× ×™ ×œ×¤× ×™ ×”×¦×‘×ª ×”××›×•×œ×”',
                    '×‘××§×•××•×ª ×©×œ ×—× ×™×” ××•×¡×“×¨×ª/×ª×• ××–×•×¨×™ × ×“×¨×© ××™×©×•×¨ ××™×•×—×“',
                    '×™×© ×œ×¡××Ÿ ××ª ×”××›×•×œ×” ×‘×××¦×¢×•×ª ××—×–×™×¨×™ ××•×¨ ×‘×©×¢×•×ª ×”×—×©×™×›×”',
                    '××™×Ÿ ×œ×”×©××™×¨ ××›×•×œ×” ×‘×¨×—×•×‘ ××¢×œ 7 ×™××™× ×œ×œ× ××™×©×•×¨ ××™×•×—×“',
                    '×™×© ×œ×›×¡×•×ª ××ª ×”××›×•×œ×” ×‘×¡×•×£ ×™×•× ×”×¢×‘×•×“×”'
                ],
                permitLink: 'https://www.jerusalem.muni.il'
            },
            'haifa': {
                title: '×ª×§× ×•×ª ×”×¦×‘×ª ××›×•×œ×•×ª ×‘×—×™×¤×”',
                regulations: [
                    '×™×© ×œ×”×¦×™×‘ ××ª ×”××›×•×œ×” ×‘××§×•× ×©××™× ×• ××¤×¨×™×¢ ×œ×ª× ×•×¢×”',
                    '×™×© ×œ×¡××Ÿ ××ª ×”××›×•×œ×” ×‘×××¦×¢×•×ª ××—×–×™×¨×™ ××•×¨ ×‘×©×¢×•×ª ×”×—×©×™×›×”',
                    '×™×© ×œ×§×‘×œ ××™×©×•×¨ ××”×¢×™×¨×™×™×” ×œ×”×¦×‘×ª ××›×•×œ×” ×‘×©×˜×— ×¦×™×‘×•×¨×™',
                    '××™×Ÿ ×œ×”×©××™×¨ ××›×•×œ×” ×‘×¨×—×•×‘ ××¢×œ 10 ×™××™× ×œ×œ× ××™×©×•×¨ ××™×•×—×“',
                    '×™×© ×œ×”×§×¤×™×“ ×¢×œ × ×™×§×™×•×Ÿ ×¡×‘×™×‘×ª ×”××›×•×œ×”'
                ],
                permitLink: 'https://www.haifa.muni.il'
            },
            'rishon': {
                title: '×ª×§× ×•×ª ×”×¦×‘×ª ××›×•×œ×•×ª ×‘×¨××©×•×Ÿ ×œ×¦×™×•×Ÿ',
                regulations: [
                    '×™×© ×œ×”×¦×™×‘ ××ª ×”××›×•×œ×” ×‘××§×•× ×©××™× ×• ××¤×¨×™×¢ ×œ×ª× ×•×¢×”',
                    '×™×© ×œ×¡××Ÿ ××ª ×”××›×•×œ×” ×‘×××¦×¢×•×ª ××—×–×™×¨×™ ××•×¨ ×‘×©×¢×•×ª ×”×—×©×™×›×”',
                    '×™×© ×œ×§×‘×œ ××™×©×•×¨ ××”×¢×™×¨×™×™×” ×œ×”×¦×‘×ª ××›×•×œ×” ×‘×©×˜×— ×¦×™×‘×•×¨×™',
                    '××™×Ÿ ×œ×”×©××™×¨ ××›×•×œ×” ×‘×¨×—×•×‘ ××¢×œ 7 ×™××™× ×œ×œ× ××™×©×•×¨ ××™×•×—×“',
                    '×™×© ×œ×›×¡×•×ª ××ª ×”××›×•×œ×” ×‘×¡×•×£ ×™×•× ×”×¢×‘×•×“×”'
                ],
                permitLink: 'https://www.rishonlezion.muni.il'
            },
            'petah-tikva': {
                title: '×ª×§× ×•×ª ×”×¦×‘×ª ××›×•×œ×•×ª ×‘×¤×ª×— ×ª×§×•×•×”',
                regulations: [
                    '×™×© ×œ×”×¦×™×‘ ××ª ×”××›×•×œ×” ×‘××§×•× ×©××™× ×• ××¤×¨×™×¢ ×œ×ª× ×•×¢×”',
                    '×™×© ×œ×¡××Ÿ ××ª ×”××›×•×œ×” ×‘×××¦×¢×•×ª ××—×–×™×¨×™ ××•×¨ ×‘×©×¢×•×ª ×”×—×©×™×›×”',
                    '×™×© ×œ×§×‘×œ ××™×©×•×¨ ××”×¢×™×¨×™×™×” ×œ×”×¦×‘×ª ××›×•×œ×” ×‘×©×˜×— ×¦×™×‘×•×¨×™',
                    '××™×Ÿ ×œ×”×©××™×¨ ××›×•×œ×” ×‘×¨×—×•×‘ ××¢×œ 5 ×™××™× ×œ×œ× ××™×©×•×¨ ××™×•×—×“',
                    '×™×© ×œ×”×§×¤×™×“ ×¢×œ × ×™×§×™×•×Ÿ ×¡×‘×™×‘×ª ×”××›×•×œ×”'
                ],
                permitLink: 'https://www.petah-tikva.muni.il'
            },
            'other': {
                title: '×ª×§× ×•×ª ×›×œ×œ×™×•×ª ×œ×”×¦×‘×ª ××›×•×œ×•×ª',
                regulations: [
                    '×™×© ×œ×”×¦×™×‘ ××ª ×”××›×•×œ×” ×‘××§×•× ×©××™× ×• ××¤×¨×™×¢ ×œ×ª× ×•×¢×”',
                    '×™×© ×œ×¡××Ÿ ××ª ×”××›×•×œ×” ×‘×××¦×¢×•×ª ××—×–×™×¨×™ ××•×¨ ×‘×©×¢×•×ª ×”×—×©×™×›×”',
                    '×™×© ×œ×§×‘×œ ××™×©×•×¨ ××”×¨×©×•×ª ×”××§×•××™×ª ×œ×”×¦×‘×ª ××›×•×œ×” ×‘×©×˜×— ×¦×™×‘×•×¨×™',
                    '×™×© ×œ×•×•×“× ×©×”××›×•×œ×” ××™× ×” ×—×•×¡××ª ×’×™×©×” ×œ×—× ×™×•×ª, ××“×¨×›×•×ª ××• ×›× ×™×¡×•×ª ×œ×‘× ×™×™× ×™×',
                    '××™×Ÿ ×œ×”×©××™×¨ ××›×•×œ×” ×‘×¨×—×•×‘ ××¢×œ 10 ×™××™× ×œ×œ× ××™×©×•×¨ ××™×•×—×“'
                ],
                permitLink: 'https://www.gov.il'
            }
        };
        
        // Container information
        const containerInfo = {
            '8': {
                size: '8 ×§×•×‘',
                dimensions: '3.8 ××˜×¨ ××•×¨×š, 1.8 ××˜×¨ ×¨×•×—×‘, 1.2 ××˜×¨ ×’×•×‘×”',
                suitable: '××ª××™× ×œ×©×™×¤×•×¦×™× ×§×˜× ×™× ×¢×“ ×‘×™× ×•× ×™×™×, ×¤×™× ×•×™ ×¤×¡×•×œ×ª ×‘× ×™×™×Ÿ ××“×™×¨×”',
                price: '1200 â‚ª + ××¢"×'
            },
            '16': {
                size: '16 ×§×•×‘',
                dimensions: '4.8 ××˜×¨ ××•×¨×š, 2.2 ××˜×¨ ×¨×•×—×‘, 1.5 ××˜×¨ ×’×•×‘×”',
                suitable: '××ª××™× ×œ×©×™×¤×•×¦×™× ×’×“×•×œ×™×, ×¤×¨×•×™×§×˜×™ ×‘× ×™×™×”, ×”×¨×™×¡×•×ª',
                price: '1200 â‚ª + ××¢"×'
            }
        };
        
        // Branches information
        const branches = [
            {
                name: '×¡× ×™×£ ××¨×›×–',
                address: '×¨×—\' ×”××œ××›×” 8, ×ª×œ ××‘×™×‘',
                phone: '03-1234567',
                hours: '×-×” 07:00-17:00, ×• 07:00-13:00'
            },
            {
                name: '×¡× ×™×£ ×¦×¤×•×Ÿ',
                address: '×¨×—\' ×”×—×¨×•×©×ª 12, ×—×™×¤×”',
                phone: '04-7654321',
                hours: '×-×” 07:00-17:00, ×• 07:00-13:00'
            },
            {
                name: '××•×§×“ ×”×–×× ×•×ª ××¨×¦×™',
                address: '×©×™×¨×•×ª ×˜×œ×¤×•× ×™',
                phone: '1-800-123-456',
                hours: '×-×” 07:00-19:00, ×• 07:00-13:00'
            }
        ];
        
        // Motivational phrases with emojis
        const motivationalPhrases = [
            {text: "×¤×™× ×•×™ ×¤×¡×•×œ×ª ×‘× ×™×™×Ÿ ×‘××•×¤×Ÿ ××¡×•×“×¨ ×ª×•×¨× ×œ×¡×‘×™×‘×” ×•×œ×§×”×™×œ×”! ğŸŒ±", emoji: "ğŸŒ±"},
            {text: "×›×œ ××›×•×œ×” ×©××¤×•× ×” ×›×¨××•×™ - ×¢×•×“ ×¦×¢×“ ×œ×¢×ª×™×“ ×™×¨×•×§ ×™×•×ª×¨! ğŸŒ", emoji: "ğŸŒ"},
            {text: "××™×—×–×•×¨ ×¤×¡×•×œ×ª ×‘× ×™×™×Ÿ ×—×•×¡×š ××©××‘×™× ×™×§×¨×™× ×œ×›×“×•×¨ ×”××¨×¥! â™»ï¸", emoji: "â™»ï¸"},
            {text: "×”×–××Ÿ ×”×›×™ ×˜×•×‘ ×œ×¤× ×•×ª ×¤×¡×•×œ×ª ×‘× ×™×™×Ÿ ×”×•× ×¢×›×©×™×•! â±ï¸", emoji: "â±ï¸"},
            {text: "×¤×™× ×•×™ ×¤×¡×•×œ×ª ×‘× ×™×™×Ÿ ×‘××•×¤×Ÿ ×—×•×§×™ ××•× ×¢ ×§× ×¡×•×ª ×•×©×•××¨ ×¢×œ ×”×¡×‘×™×‘×”! ğŸ‘", emoji: "ğŸ‘"},
            {text: "×—.×¡×‘×Ÿ ××—×œ×§×ª ××›×•×œ×•×ª - ×”×¤×ª×¨×•×Ÿ ×”××§×¦×•×¢×™ ×œ×¤×™× ×•×™ ×¤×¡×•×œ×ª ×‘× ×™×™×Ÿ! ğŸ—ï¸", emoji: "ğŸ—ï¸"},
            {text: "×¤×¨×™×¡×” ××¨×¦×™×ª ×©×œ × ×”×’×™× ××§×¦×•×¢×™×™× ×œ×©×™×¨×•×ª ××”×™×¨ ×•×™×¢×™×œ! ğŸšš", emoji: "ğŸšš"},
            {text: "×× ×—× ×• ××˜××™× ×™× ×‘××ª×¨×™× ××•×¨×©×™× ×‘×œ×‘×“ ×¢×œ ×™×“×™ ×”××©×¨×“ ×œ××™×›×•×ª ×”×¡×‘×™×‘×”! ğŸ“", emoji: "ğŸ“"},
            {text: "×©×™×¨×•×ª ××ª×§×“× ×•××”×™×¨ ×¢× ×¦×™ ××©××™×•×ª ×—×“×™×© ×•××›×•×œ×•×ª ××™×›×•×ª×™×•×ª! ğŸ”„", emoji: "ğŸ”„"},
            {text: "×‘×—×™×¨×” × ×›×•× ×” ×©×œ ××›×•×œ×” ×—×•×¡×›×ª ×–××Ÿ ×•×›×¡×£! ğŸ’°", emoji: "ğŸ’°"}
        ];
        
        // Jokes
        const jokes = [
            {
                setup: "×œ××” ×¤×¡×•×œ×ª ×‘× ×™×™×Ÿ ×ª××™×“ ××¨×’×™×©×” ×‘×•×“×“×”? ğŸ—ï¸",
                punchline: "×›×™ ××£ ××—×“ ×œ× ×¨×•×¦×” ×œ×”×™×•×ª ××™×ª×” ×‘×§×©×¨! ğŸ˜…"
            },
            {
                setup: "××” ×××¨×” ××›×•×œ×ª ×”×¤×¡×•×œ×ª ×œ××©××™×ª? ğŸšš",
                punchline: "××ª×” ×ª××™×“ ××¨×™× ××•×ª×™ ×›×©×× ×™ ×œ××˜×”! ğŸ’ª"
            },
            {
                setup: "××™×š ×§×•×¨××™× ×œ××“× ×©××•×¡×£ ×¤×¡×•×œ×ª ×‘× ×™×™×Ÿ? ğŸ§±",
                punchline: "××¡×¤×Ÿ ××™×•×—×“ ×‘××™× ×•! â™»ï¸"
            }
        ];
        
        // FAQ Database
        const faqDatabase = [
            {
                question: "××” ×”××—×™×¨ ×œ×”×¦×‘×ª ××›×•×œ×”?",
                answer: "××—×™×¨ ×”×¦×‘×ª ××›×•×œ×” ××• ×”×—×œ×¤×ª ××›×•×œ×” ×”×•× 1200 â‚ª + ××¢\"×. ×”××—×™×¨ ×–×”×” ×¢×‘×•×¨ ××›×•×œ×•×ª ×‘×’×•×“×œ 8 ×§×•×‘ ×•-16 ×§×•×‘."
            },
            {
                question: "××™×œ×• ×’×“×œ×™× ×©×œ ××›×•×œ×•×ª ×™×©?",
                answer: "×× ×—× ×• ××¦×™×¢×™× ×©× ×™ ×’×“×œ×™× ×©×œ ××›×•×œ×•×ª: ××›×•×œ×” 8 ×§×•×‘ (3.8 ××˜×¨ ××•×¨×š, 1.8 ××˜×¨ ×¨×•×—×‘, 1.2 ××˜×¨ ×’×•×‘×”) ×”××ª××™××” ×œ×©×™×¤×•×¦×™× ×§×˜× ×™× ×¢×“ ×‘×™× ×•× ×™×™×, ×•××›×•×œ×” 16 ×§×•×‘ (4.8 ××˜×¨ ××•×¨×š, 2.2 ××˜×¨ ×¨×•×—×‘, 1.5 ××˜×¨ ×’×•×‘×”) ×”××ª××™××” ×œ×©×™×¤×•×¦×™× ×’×“×•×œ×™× ×•×¤×¨×•×™×§×˜×™ ×‘× ×™×™×”."
            },
            {
                question: "××” ×”×ª×§× ×•×ª ×œ×”×¦×‘×ª ××›×•×œ×”?",
                answer: "×”×¦×‘×ª ××›×•×œ×•×ª ×¤×¡×•×œ×ª ×‘× ×™×™×Ÿ ×›×¤×•×¤×” ×œ×ª×§× ×•×ª ×¢×™×¨×•× ×™×•×ª ×©×•× ×•×ª. ×‘××•×¤×Ÿ ×›×œ×œ×™, ×™×© ×œ×”×¦×™×‘ ××ª ×”××›×•×œ×” ×‘××§×•× ×©××™× ×• ××¤×¨×™×¢ ×œ×ª× ×•×¢×”, ×œ×¡××Ÿ ××•×ª×” ×‘××—×–×™×¨×™ ××•×¨ ×‘×©×¢×•×ª ×”×—×©×™×›×”, ×•××™×Ÿ ×œ×”×¦×™×‘ ×‘××¨×—×§ ×”×§×˜×Ÿ ×-20 ××˜×¨ ××¤×ª×— ×‘× ×™×™×Ÿ. ×”×¦×‘×ª ××›×•×œ×” ×‘×©×˜×— ×¦×™×‘×•×¨×™ ×“×•×¨×©×ª ×”×™×ª×¨ ××”×¢×™×¨×™×™×”."
            },
            {
                question: "×›××” ×–××Ÿ ××¤×©×¨ ×œ×”×©××™×¨ ××›×•×œ×”?",
                answer: "××©×š ×”×©×™××•×© ×”×¡×˜× ×“×¨×˜×™ ×”×•× ×¢×“ 10 ×™××™×, ××š ×–×” ×ª×œ×•×™ ×‘×ª×§× ×•×ª ×”×¢×™×¨×™×™×” ×”××§×•××™×ª. ×‘×¢×¨×™× ××¡×•×™××•×ª ×”×ª×§×•×¤×” ×”××§×¡×™××œ×™×ª ×œ×œ× ×”×™×ª×¨ ××™×•×—×“ ×”×™× 7 ×™××™× ×‘×œ×‘×“."
            },
            {
                question: "×”×× ××ª× ××¡×¤×§×™× ××™×©×•×¨×™ ×”×˜×× ×”?",
                answer: "×›×Ÿ, ×× ×—× ×• ××˜××™× ×™× ×¤×¡×•×œ×ª ×‘× ×™×™×Ÿ ×‘××ª×¨×™× ××•×¨×©×™× ×‘×œ×‘×“ ×¢×œ ×™×“×™ ×”××©×¨×“ ×œ××™×›×•×ª ×”×¡×‘×™×‘×”, ×•××¡×¤×§×™× ××™×©×•×¨×™ ×”×˜×× ×” (×˜×•×¤×¡ 4) ×œ×¤×™ ×“×¨×™×©×”."
            }
        ];
        
        // Initialize chat
        document.addEventListener('DOMContentLoaded', function() {
            // Auto-resize textarea
            const textarea = document.getElementById('user-input');
            textarea.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = (this.scrollHeight) + 'px';
            });
            
            // Start with greeting
            setTimeout(() => {
                addBotMessage("×©×œ×•× ×•×‘×¨×•×š ×”×‘× ×”×–×× ×ª ××›×•×œ×” ××•×Ÿ ×œ×™×™×Ÿ ×¤×¡×•×œ×ª ×‘× ×™×™×Ÿ! ×× ×™ ×”×‘×™× ×” ×”××œ××›×•×ª×™×ª ×©×œ ×”×—×‘×¨×”, ×›××Ÿ ×›×“×™ ×œ×¡×™×™×¢ ×œ×š ×‘×›×œ ×©××œ×” ×‘× ×•×©× ×¤×™× ×•×™ ×¤×¡×•×œ×ª ×‘× ×™×™×Ÿ, ×”×¦×‘×ª ××›×•×œ×•×ª ×•×”×™×ª×¨×™×. ×¢× ××™ ×™×© ×œ×™ ×”×›×‘×•×“ ×œ×©×•×—×— ×”×™×•×?");
            }, 500);
            
            // Add some quick actions after a delay
            setTimeout(() => {
                addQuickActions([
                    '××” ×”××—×™×¨ ×œ×”×¦×‘×ª ××›×•×œ×”?',
                    '××™×œ×• ×’×“×œ×™× ×©×œ ××›×•×œ×•×ª ×™×©?',
                    '××” ×”×ª×§× ×•×ª ×œ×”×¦×‘×ª ××›×•×œ×”?',
                    '×”×–×× ×” ×—×“×©×”'
                ]);
            }, 1000);
        });
        
        // Switch between form tabs
        function switchTab(tabId) {
            // Hide all tabs
            document.querySelectorAll('.form-tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Deactivate all tab buttons
            document.querySelectorAll('.form-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Activate selected tab
            document.getElementById(tabId).classList.add('active');
            
            // Activate tab button
            document.querySelectorAll('.form-tab').forEach(tab => {
                if (tab.getAttribute('onclick').includes(tabId)) {
                    tab.classList.add('active');
                }
            });
        }
        
        // Update city regulations
        function updateCityRegulations() {
            const citySelect = document.getElementById('city-select');
            const cityValue = citySelect.value;
            const cityRegulationsDiv = document.getElementById('city-regulations');
            const regulationsContent = document.getElementById('regulations-content');
            const permitLink = document.getElementById('permit-link');
            
            if (cityValue && cityRegulations[cityValue]) {
                const cityData = cityRegulations[cityValue];
                
                regulationsContent.innerHTML = `
                    <h5>${cityData.title}</h5>
                    <ul style="padding-right: 20px; margin-top: 5px;">
                        ${cityData.regulations.map(reg => `<li>${reg}</li>`).join('')}
                    </ul>
                `;
                
                permitLink.innerHTML = `
                    <a href="${cityData.permitLink}" target="_blank" class="btn btn-outline" style="font-size: 0.85rem;">
                        <i class="fas fa-file-alt"></i> ×˜×•×¤×¡ ×‘×§×©×ª ×”×™×ª×¨ ×œ×”×¦×‘×ª ××›×•×œ×”
                    </a>
                `;
                
                cityRegulationsDiv.style.display = 'block';
            } else {
                cityRegulationsDiv.style.display = 'none';
            }
        }
        
        // Select service type
        function selectService(service) {
            selectedService = service;
            
            // Highlight selected service
            document.querySelectorAll('.branch-card').forEach(card => {
                card.style.boxShadow = '0 2px 5px rgba(0, 0, 0, 0.1)';
            });
            
            const serviceCards = document.querySelectorAll('.branch-card');
            if (service === 'placement') {
                serviceCards[0].style.boxShadow = '0 0 0 3px var(--placement-color), 0 5px 15px rgba(0, 0, 0, 0.1)';
            } else if (service === 'replacement') {
                serviceCards[1].style.boxShadow = '0 0 0 3px var(--replacement-color), 0 5px 15px rgba(0, 0, 0, 0.1)';
            } else if (service === 'removal') {
                serviceCards[2].style.boxShadow = '0 0 0 3px var(--removal-color), 0 5px 15px rgba(0, 0, 0, 0.1)';
            }
        }
        
        // Add a message from the bot with typing animation
        function addBotMessage(text, isCalculation = false, isMotivation = false, isJoke = false, isFAQ = false) {
            const chatMessages = document.getElementById('chat-messages');
            
            // Create typing indicator
            const typingIndicator = document.createElement('div');
            typingIndicator.className = 'typing-indicator';
            typingIndicator.innerHTML = `
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
            `;
            chatMessages.appendChild(typingIndicator);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            // Remove typing indicator after delay and add message
            setTimeout(() => {
                chatMessages.removeChild(typingIndicator);
                
                const messageDiv = document.createElement('div');
                
                if (isCalculation) {
                    messageDiv.className = 'message calculation-message';
                    messageDiv.innerHTML = text;
                } else if (isMotivation) {
                    messageDiv.className = 'message motivation-message';
                    // Add emoji with animation
                    const emoji = text.emoji;
                    const textWithoutEmoji = text.text.replace(emoji, '');
                    messageDiv.innerHTML = `${textWithoutEmoji} <span class="emoji">${emoji}</span>`;
                } else if (isJoke) {
                    messageDiv.className = 'message joke-message';
                    messageDiv.innerHTML = `
                        <div>${text.setup}</div>
                        <div class="punchline">${text.punchline} <span class="emoji">${text.punchline.match(/[\u{1F600}-\u{1F6FF}]/u)?.[0] || ''}</span></div>
                    `;
                } else if (isFAQ) {
                    messageDiv.className = 'message';
                    messageDiv.innerHTML = `
                        <div class="faq-container">
                            ${text}
                        </div>
                    `;
                    
                    // Add event listeners to FAQ items
                    setTimeout(() => {
                        document.querySelectorAll('.faq-question').forEach(question => {
                            question.addEventListener('click', function() {
                                this.classList.toggle('active');
                                const answer = this.nextElementSibling;
                                answer.classList.toggle('active');
                                
                                // Scroll to the question when opened
                                if (this.classList.contains('active')) {
                                    this.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                                }
                            });
                        });
                    }, 100);
                } else {
                    messageDiv.className = 'message bot-message';
                    // Highlight user name if mentioned
                    if (userName) {
                        const nameWithEmoji = `<span class="user-name ${userGender}">${userName}</span>`;
                        text = text.replace(userName, nameWithEmoji);
                    }
                    messageDiv.innerHTML = text;
                }
                
                chatMessages.appendChild(messageDiv);
                chatMessages.scrollTop = chatMessages.scrollHeight;
                
                // Highlight new message
                messageDiv.classList.add('new-message');
                setTimeout(() => {
                    messageDiv.classList.remove('new-message');
                }, 1500);
            }, 1500);
        }
        
        // Add a message from the user
        function addUserMessage(text) {
            const chatMessages = document.getElementById('chat-messages');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message user-message';
            messageDiv.textContent = text;
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            // Highlight new message
            messageDiv.classList.add('new-message');
            setTimeout(() => {
                messageDiv.classList.remove('new-message');
            }, 1500);
        }
        
        // Add quick actions buttons
        function addQuickActions(actions) {
            const quickActions = document.getElementById('quick-actions');
            quickActions.innerHTML = '';
            
            actions.forEach(action => {
                const actionButton = document.createElement('div');
                
                // Check if action is HTML or plain text
                if (action.startsWith('<div')) {
                    actionButton.innerHTML = action;
                    // Get the first child (the actual button)
                    const btn = actionButton.firstChild;
                    btn.onclick = function() {
                        sendQuickMessage(btn.textContent.trim());
                    };
                    quickActions.appendChild(btn);
                } else {
                    actionButton.className = 'quick-action';
                    
                    // Add special class based on action type
                    if (action.includes('×”×¦×‘×”') || action.includes('×”×¦×‘×ª')) {
                        actionButton.classList.add('placement-action');
                    } else if (action.includes('×”×—×œ×¤×”') || action.includes('×”×—×œ×¤×ª')) {
                        actionButton.classList.add('replacement-action');
                    } else if (action.includes('×”×•×¦××”') || action.includes('×”×•×¦××ª')) {
                        actionButton.classList.add('removal-action');
                    } else if (action.includes('×”×–×× ×”') || action.includes('×—×“×©×”')) {
                        actionButton.classList.add('new-order-action');
                    }
                    
                    actionButton.textContent = action;
                    actionButton.onclick = function() {
                        sendQuickMessage(action);
                    };
                    quickActions.appendChild(actionButton);
                }
            });
        }
        
        // Send a quick message (from button click)
        function sendQuickMessage(text) {
            addUserMessage(text);
            processUserInput(text);
        }
        
        // Send a message (from input field)
        function sendMessage() {
            const userInput = document.getElementById('user-input');
            const text = userInput.value.trim();
            
            if (text) {
                addUserMessage(text);
                userInput.value = '';
                userInput.style.height = 'auto';
                processUserInput(text);
            }
        }
        
        // Handle Enter key press (Shift+Enter for new line)
        function handleKeyPress(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendMessage();
            }
        }
        
        // Process user input and generate response
        function processUserInput(text) {
            // Check if we're in the middle of a conversation
            if (conversationState === 'greeting') {
                userName = text;
                // Simple gender detection (could be improved)
                if (text.endsWith('×”') || text.endsWith('×ª') || text.endsWith('×')) {
                    userGender = 'female';
                } else {
                    userGender = 'male';
                }
                
                const greeting = userGender === 'female' ? 
                    `××™×–×” ×›×™×£ ×œ×”×›×™×¨ ××•×ª×š ${userName}! ××™×š ×× ×™ ×™×›×•×œ×” ×œ×¢×–×•×¨ ×œ×š ×”×™×•× ×‘× ×•×©× ×¤×™× ×•×™ ×¤×¡×•×œ×ª ×‘× ×™×™×Ÿ?` :
                    `××™×–×” ×›×™×£ ×œ×”×›×™×¨ ××•×ª×š ${userName}! ××™×š ×× ×™ ×™×›×•×œ ×œ×¢×–×•×¨ ×œ×š ×”×™×•× ×‘× ×•×©× ×¤×™× ×•×™ ×¤×¡×•×œ×ª ×‘× ×™×™×Ÿ?`;
                
                addBotMessage(greeting);
                conversationState = 'normal';
                
                // Add a motivational phrase
                setTimeout(() => {
                    const randomMotivation = motivationalPhrases[Math.floor(Math.random() * motivationalPhrases.length)];
                    addBotMessage(randomMotivation, false, true);
                }, 2000);
                
                return;
            }
            
            // Normal conversation processing
            // Convert to lowercase and remove spaces for better matching
            const normalizedText = text.toLowerCase().replace(/\s+/g, '');
            
            // Check for keywords (at least 2 characters)
            if (normalizedText.length >= 2) {
                // Check for price
                if (normalizedText.includes('××—×™×¨') || normalizedText.includes('×¢×œ×•×ª') || 
                    normalizedText.includes('×›××”') || normalizedText.includes('×ª×©×œ×•×') || 
                    normalizedText.includes('×ª×¢×¨×™×£') || normalizedText.includes('×©×§×œ')) {
                    handlePriceQuestion();
                    return;
                }
                
                // Check for size
                if (normalizedText.includes('×’×•×“×œ') || normalizedText.includes('×’×“×œ') || 
                    normalizedText.includes('××™×“×•×ª') || normalizedText.includes('×§×•×‘') || 
                    normalizedText.includes('× ×¤×—') || normalizedText.includes('×××“×™×')) {
                    handleSizeQuestion();
                    return;
                }
                
                // Check for regulations
                if (normalizedText.includes('×ª×§× ×•×ª') || normalizedText.includes('×—×•×§') || 
                    normalizedText.includes('×”×™×ª×¨') || normalizedText.includes('××™×©×•×¨') || 
                    normalizedText.includes('×¢×™×¨×™×™×”') || normalizedText.includes('×¨×™×©×™×•×Ÿ')) {
                    handleRegulationsQuestion();
                    return;
                }
                
                // Check for order
                if (normalizedText.includes('×”×–×× ×”') || normalizedText.includes('×œ×”×–××™×Ÿ') || 
                    normalizedText.includes('×œ×¨×›×•×©') || normalizedText.includes('×œ×§× ×•×ª') || 
                    normalizedText.includes('×˜×•×¤×¡') || normalizedText.includes('×¨×›×™×©×”')) {
                    handleOrderRequest();
                    return;
                }
                
                // Check for branches
                if (normalizedText.includes('×¡× ×™×£') || normalizedText.includes('×¡× ×™×¤×™×') || 
                    normalizedText.includes('××™×§×•×') || normalizedText.includes('×›×ª×•×‘×ª') || 
                    normalizedText.includes('××™×¤×”') || normalizedText.includes('×˜×œ×¤×•×Ÿ')) {
                    showBranches();
                    return;
                }
                
                // Check for joke
                if (normalizedText.includes('×‘×“×™×—×”') || normalizedText.includes('××¦×—×™×§') || 
                    normalizedText.includes('×œ×¦×—×•×§') || normalizedText.includes('×”×•××•×¨')) {
                    tellJoke();
                    return;
                }
                
                // Check for disposal certification
                if (normalizedText.includes('××™×©×•×¨') || normalizedText.includes('×”×˜×× ×”') || 
                    normalizedText.includes('×ª×¢×•×“×”') || normalizedText.includes('×˜×•×¤×¡4') || 
                    normalizedText.includes('××›×œ×•×¡') || normalizedText.includes('××¡××š')) {
                    handleDisposalCertificationQuestion();
                    return;
                }
                
                // Check for thanks
                if (normalizedText.includes('×ª×•×“×”') || normalizedText.includes('×ª×•×“×”×¨×‘×”') || 
                    normalizedText.includes('××¢×¨×™×š') || normalizedText.includes('××•×“×”')) {
                    addBotMessage(userGender === 'female' ? 
                        `×‘×›×™×£ ${userName}! ×ª××™×“ ×›××Ÿ ×‘×©×‘×™×œ×š. ×™×© ×¢×•×“ ××©×”×• ×©××ª ×¦×¨×™×›×”?` :
                        `×‘×›×™×£ ${userName}! ×ª××™×“ ×›××Ÿ ×‘×©×‘×™×œ×š. ×™×© ×¢×•×“ ××©×”×• ×©××ª×” ×¦×¨×™×š?`);
                    return;
                }
                
                // Check for container placement
                if ((normalizedText.includes('××›×•×œ×”') || normalizedText.includes('×¤×¡×•×œ×ª')) && 
                    (normalizedText.includes('×”×¦×‘×”') || normalizedText.includes('×œ×”×¦×™×‘') || 
                     normalizedText.includes('×©×™×') || normalizedText.includes('×œ×©×™×'))) {
                    handleContainerPlacementQuestion();
                    return;
                }
                
                // Check for container replacement
                if ((normalizedText.includes('××›×•×œ×”') || normalizedText.includes('×¤×¡×•×œ×ª')) && 
                    (normalizedText.includes('×”×—×œ×¤×”') || normalizedText.includes('×œ×”×—×œ×™×£') || 
                     normalizedText.includes('×—×“×©×”') || normalizedText.includes('××œ××”'))) {
                    handleContainerReplacementQuestion();
                    return;
                }
                
                // Check for container removal
                if ((normalizedText.includes('××›×•×œ×”') || normalizedText.includes('×¤×¡×•×œ×ª')) && 
                    (normalizedText.includes('×”×•×¦××”') || normalizedText.includes('×œ×”×•×¦×™×') || 
                     normalizedText.includes('×¤×™× ×•×™') || normalizedText.includes('×œ×¤× ×•×ª'))) {
                    handleContainerRemovalQuestion();
                    return;
                }
                
                // Check for 3D view
                if (normalizedText.includes('3d') || normalizedText.includes('×ª×œ×ª××™××“') || 
                    normalizedText.includes('××•×“×œ') || normalizedText.includes('×”×“××™×”') || 
                    normalizedText.includes('×ª××•× ×”')) {
                    showContainerModel();
                    return;
                }
                
                // Check for FAQ
                if (normalizedText.includes('×©××œ×•×ª') || normalizedText.includes('×ª×©×•×‘×•×ª') || 
                    normalizedText.includes('× ×¤×•×¦×•×ª') || normalizedText.includes('×©××œ×”')) {
                    showFAQ();
                    return;
                }
                
                // Check for general container question
                if (normalizedText.includes('××›×•×œ×”') || normalizedText.includes('×¤×¡×•×œ×ª') || 
                    normalizedText.includes('×‘× ×™×™×Ÿ') || normalizedText.includes('×©×™×¤×•×¥')) {
                    handleGeneralContainerQuestion();
                    return;
                }
            }
            
            // Default response
            addBotMessage(userGender === 'female' ? 
                `${userName}, ×× ×™ ×œ× ×‘×˜×•×— ×©×”×‘× ×ª×™ ×‘×“×™×•×§ ×œ××” ××ª ××ª×›×•×•× ×ª. ××•×œ×™ ××ª ×™×›×•×œ×” ×œ×¤×¨×˜?` :
                `${userName}, ×× ×™ ×œ× ×‘×˜×•×— ×©×”×‘× ×ª×™ ×‘×“×™×•×§ ×œ××” ××ª×” ××ª×›×•×•×Ÿ. ××•×œ×™ ××ª×” ×™×›×•×œ ×œ×¤×¨×˜?`);
            
            // Show quick actions to help
            setTimeout(() => {
                addQuickActions([
                    '<div class="quick-action placement-action"><i class="fas fa-truck-loading"></i> ×”×¦×‘×ª ××›×•×œ×”</div>',
                    '<div class="quick-action replacement-action"><i class="fas fa-exchange-alt"></i> ×”×—×œ×¤×ª ××›×•×œ×”</div>',
                    '<div class="quick-action removal-action"><i class="fas fa-trash-restore"></i> ×”×•×¦××ª ××›×•×œ×”</div>',
                    '<div class="quick-action"><i class="fas fa-ruler-combined"></i> ×’×“×œ×™ ××›×•×œ×•×ª</div>',
                    '<div class="quick-action"><i class="fas fa-question-circle"></i> ×©××œ×•×ª × ×¤×•×¦×•×ª</div>'
                ]);
            }, 500);
        }
        
        // Show container 3D model
        function showContainerModel() {
            addBotMessage("×× ×™ ××©××— ×œ×”×¦×™×’ ×œ×š ×”×“××™×” ×ª×œ×ª ××™××“×™×ª ×©×œ ×”××›×•×œ×•×ª ×©×œ× ×•.");
            
            setTimeout(() => {
                // Load the 3D model script
                const script = document.createElement('script');
                script.src = '/home/ubuntu/container-3d-model.js';
                document.body.appendChild(script);
                
                // Show the popup after script is loaded
                script.onload = function() {
                    document.getElementById('container-model-popup').style.display = 'flex';
                    // Initialize with 8 cubic meter container by default
                    switchContainerModel(8);
                };
                
                script.onerror = function() {
                    addBotMessage("××¦×˜×¢×¨, ×œ× ×”×¦×œ×—×ª×™ ×œ×˜×¢×•×Ÿ ××ª ×”××•×“×œ ×”×ª×œ×ª ××™××“×™. ×× ×¡×” ×œ×”×¦×™×’ ×œ×š ××ª ×”××™×“×•×ª ×‘×¦×•×¨×” ××—×¨×ª.");
                    handleSizeQuestion();
                };
            }, 1000);
        }
        
        // Close container model popup
        function closeContainerModelPopup() {
            document.getElementById('container-model-popup').style.display = 'none';
        }
        
        // Switch between container models
        function switchContainerModel(size) {
            const viewer = document.getElementById('container-model-viewer');
            
            // Clear previous model
            while (viewer.firstChild) {
                viewer.removeChild(viewer.firstChild);
            }
            
            // Update button styles
            if (size === 8) {
                document.getElementById('model-8kub').className = 'btn btn-primary';
                document.getElementById('model-16kub').className = 'btn btn-secondary';
            } else {
                document.getElementById('model-8kub').className = 'btn btn-secondary';
                document.getElementById('model-16kub').className = 'btn btn-primary';
            }
            
            // Initialize new model
            initContainerModel('container-model-viewer', size);
        }
        
        // Handle price question
        function handlePriceQuestion() {
            addBotMessage("××—×™×¨ ×”×¦×‘×ª ××›×•×œ×” ××• ×”×—×œ×¤×ª ××›×•×œ×” ×”×•× 1200 â‚ª + ××¢\"×.");
            
            setTimeout(() => {
                addBotMessage(`
                    <h4>××—×™×¨×•×Ÿ ×©×™×¨×•×ª×™×:</h4>
                    <ul>
                        <li><i class="fas fa-truck-loading"></i> ×”×¦×‘×ª ××›×•×œ×” - 1200 â‚ª + ××¢"×</li>
                        <li><i class="fas fa-exchange-alt"></i> ×”×—×œ×¤×ª ××›×•×œ×” - 1200 â‚ª + ××¢"×</li>
                        <li><i class="fas fa-trash-restore"></i> ×”×•×¦××ª ××›×•×œ×” - ×›×œ×•×œ ×‘××—×™×¨ ×”×”×¦×‘×”</li>
                    </ul>
                    <p style="margin-top: 10px;">×”××—×™×¨ ×–×”×” ×¢×‘×•×¨ ××›×•×œ×•×ª ×‘×’×•×“×œ 8 ×§×•×‘ ×•-16 ×§×•×‘.</p>
                `, true);
                
                setTimeout(() => {
                    addBotMessage("×”×× ×ª×¨×¦×” ×œ×‘×¦×¢ ×”×–×× ×”?");
                    setTimeout(() => {
                        addQuickActions([
                            '×”×–×× ×” ×—×“×©×”',
                            '××™×œ×• ×’×“×œ×™× ×©×œ ××›×•×œ×•×ª ×™×©?',
                            '××” ×”×ª×§× ×•×ª ×œ×”×¦×‘×ª ××›×•×œ×”?'
                        ]);
                    }, 500);
                }, 1000);
            }, 1000);
        }
        
        // Handle size question
        function handleSizeQuestion() {
            addBotMessage("×× ×—× ×• ××¦×™×¢×™× ×©× ×™ ×’×“×œ×™× ×©×œ ××›×•×œ×•×ª ×œ×¤×™× ×•×™ ×¤×¡×•×œ×ª ×‘× ×™×™×Ÿ:");
            
            setTimeout(() => {
                addBotMessage(`
                    <h4>×’×“×œ×™ ××›×•×œ×•×ª:</h4>
                    <div class="order-item">
                        <span class="label">××›×•×œ×” 8 ×§×•×‘:</span>
                        <span class="value">3.8 ××˜×¨ ××•×¨×š, 1.8 ××˜×¨ ×¨×•×—×‘, 1.2 ××˜×¨ ×’×•×‘×”</span>
                    </div>
                    <div class="order-item">
                        <span class="label">××›×•×œ×” 16 ×§×•×‘:</span>
                        <span class="value">4.8 ××˜×¨ ××•×¨×š, 2.2 ××˜×¨ ×¨×•×—×‘, 1.5 ××˜×¨ ×’×•×‘×”</span>
                    </div>
                `, true);
                
                setTimeout(() => {
                    addBotMessage(`
                        <h4>×”××œ×¦×•×ª ×œ×©×™××•×©:</h4>
                        <div class="order-item">
                            <span class="label">××›×•×œ×” 8 ×§×•×‘:</span>
                            <span class="value">××ª××™××” ×œ×©×™×¤×•×¦×™× ×§×˜× ×™× ×¢×“ ×‘×™× ×•× ×™×™×, ×¤×™× ×•×™ ×¤×¡×•×œ×ª ×‘× ×™×™×Ÿ ××“×™×¨×”</span>
                        </div>
                        <div class="order-item">
                            <span class="label">××›×•×œ×” 16 ×§×•×‘:</span>
                            <span class="value">××ª××™××” ×œ×©×™×¤×•×¦×™× ×’×“×•×œ×™×, ×¤×¨×•×™×§×˜×™ ×‘× ×™×™×”, ×”×¨×™×¡×•×ª</span>
                        </div>
                    `, true);
                    
                    setTimeout(() => {
                        addBotMessage("×”×× ×ª×¨×¦×” ×œ×‘×¦×¢ ×”×–×× ×”?");
                        setTimeout(() => {
                            addQuickActions([
                                '×”×–×× ×” ×—×“×©×”',
                                '××” ×”××—×™×¨ ×œ×”×¦×‘×ª ××›×•×œ×”?',
                                '××” ×”×ª×§× ×•×ª ×œ×”×¦×‘×ª ××›×•×œ×”?'
                            ]);
                        }, 500);
                    }, 1000);
                }, 2000);
            }, 1000);
        }
        
        // Handle regulations question
        function handleRegulationsQuestion() {
            addBotMessage("×”×¦×‘×ª ××›×•×œ×•×ª ×¤×¡×•×œ×ª ×‘× ×™×™×Ÿ ×›×¤×•×¤×” ×œ×ª×§× ×•×ª ×¢×™×¨×•× ×™×•×ª ×©×•× ×•×ª ×‘×”×ª×× ×œ×¢×™×¨ ×‘×” ××•×¦×‘×ª ×”××›×•×œ×”.");
            
            setTimeout(() => {
                addBotMessage(`
                    <h4>×ª×§× ×•×ª ×›×œ×œ×™×•×ª ×œ×”×¦×‘×ª ××›×•×œ×•×ª:</h4>
                    <ul>
                        <li>×™×© ×œ×”×¦×™×‘ ××ª ×”××›×•×œ×” ×‘××§×•× ×©××™× ×• ××¤×¨×™×¢ ×œ×ª× ×•×¢×”</li>
                        <li>×™×© ×œ×¡××Ÿ ××ª ×”××›×•×œ×” ×‘×××¦×¢×•×ª ××—×–×™×¨×™ ××•×¨ ×‘×©×¢×•×ª ×”×—×©×™×›×”</li>
                        <li>××™×Ÿ ×œ×”×¦×™×‘ ××›×•×œ×” ×‘××¨×—×§ ×”×§×˜×Ÿ ×-20 ××˜×¨ ××¤×ª×— ×‘× ×™×™×Ÿ</li>
                        <li>×”×¦×‘×ª ××›×•×œ×” ×‘×©×˜×— ×¦×™×‘×•×¨×™ ×“×•×¨×©×ª ×”×™×ª×¨ ××”×¢×™×¨×™×™×”</li>
                        <li>×™×© ×œ×›×¡×•×ª ××ª ×”××›×•×œ×” ×‘×¡×•×£ ×™×•× ×”×¢×‘×•×“×”</li>
                    </ul>
                `, true);
                
                setTimeout(() => {
                    addBotMessage("×‘×¢×ª ×‘×™×¦×•×¢ ×”×–×× ×”, ×ª×•×›×œ ×œ×‘×—×•×¨ ××ª ×”×¢×™×¨ ×©×œ×š ×•×œ×§×‘×œ ××™×“×¢ ××¤×•×¨×˜ ×¢×œ ×”×ª×§× ×•×ª ×”×¡×¤×¦×™×¤×™×•×ª ×•×§×™×©×•×¨ ×œ×˜×•×¤×¡ ×‘×§×©×ª ×”×™×ª×¨.");
                    
                    setTimeout(() => {
                        addBotMessage("×”×× ×ª×¨×¦×” ×œ×‘×¦×¢ ×”×–×× ×” ×•×œ×¨××•×ª ××ª ×”×ª×§× ×•×ª ×”×¡×¤×¦×™×¤×™×•×ª ×œ×¢×™×¨ ×©×œ×š?");
                        setTimeout(() => {
                            addQuickActions([
                                '×”×–×× ×” ×—×“×©×”',
                                '××” ×”××—×™×¨ ×œ×”×¦×‘×ª ××›×•×œ×”?',
                                '××™×œ×• ×’×“×œ×™× ×©×œ ××›×•×œ×•×ª ×™×©?'
                            ]);
                        }, 500);
                    }, 1000);
                }, 2000);
            }, 1000);
        }
        
        // Handle container placement question
        function handleContainerPlacementQuestion() {
            addBotMessage("×”×¦×‘×ª ××›×•×œ×” ×—×“×©×” ×‘××ª×¨ ×¢×•×œ×” 1200 â‚ª + ××¢\"×.");
            
            setTimeout(() => {
                addBotMessage(`
                    <h4 style="color: var(--placement-color);"><i class="fas fa-truck-loading"></i> ×¤×¨×˜×™× ×¢×œ ×”×¦×‘×ª ××›×•×œ×”:</h4>
                    <ul>
                        <li>×”××—×™×¨ ×›×•×œ×œ ×”×•×‘×œ×” ×œ××ª×¨ ×•×”×¦×‘×” ×‘××™×§×•× ×”××‘×•×§×©</li>
                        <li>× ×™×ª×Ÿ ×œ×‘×—×•×¨ ×‘×™×Ÿ ××›×•×œ×” ×‘×’×•×“×œ 8 ×§×•×‘ ××• 16 ×§×•×‘</li>
                        <li>×”×¦×‘×” ×‘×©×˜×— ×¦×™×‘×•×¨×™ ×“×•×¨×©×ª ×”×™×ª×¨ ××”×¢×™×¨×™×™×”</li>
                        <li>××©×š ×”×©×™××•×© ×”×¡×˜× ×“×¨×˜×™ ×”×•× ×¢×“ 10 ×™××™× (×ª×œ×•×™ ×‘×ª×§× ×•×ª ×”×¢×™×¨×™×™×”)</li>
                        <li>×—.×¡×‘×Ÿ ××¡×¤×§×ª ×©×™×¨×•×ª ××§×¦×•×¢×™ ×¢× ×¤×¨×™×¡×” ××¨×¦×™×ª ×©×œ × ×”×’×™×</li>
                    </ul>
                `, true);
                
                setTimeout(() => {
                    addBotMessage("×”×× ×ª×¨×¦×” ×œ×‘×¦×¢ ×”×–×× ×” ×œ×”×¦×‘×ª ××›×•×œ×”?");
                    setTimeout(() => {
                        addQuickActions([
                            '<div class="quick-action placement-action"><i class="fas fa-shopping-cart"></i> ×”×–×× ×” ×—×“×©×”</div>',
                            '<div class="quick-action"><i class="fas fa-ruler-combined"></i> ××™×œ×• ×’×“×œ×™× ×©×œ ××›×•×œ×•×ª ×™×©?</div>',
                            '<div class="quick-action"><i class="fas fa-clipboard-list"></i> ××” ×”×ª×§× ×•×ª ×œ×”×¦×‘×ª ××›×•×œ×”?</div>'
                        ]);
                    }, 500);
                }, 1000);
            }, 1000);
        }
        
        // Handle container replacement question
        function handleContainerReplacementQuestion() {
            addBotMessage("×”×—×œ×¤×ª ××›×•×œ×” ××œ××” ×‘×¨×™×§×” ×¢×•×œ×” 1200 â‚ª + ××¢\"×.");
            
            setTimeout(() => {
                addBotMessage(`
                    <h4 style="color: var(--replacement-color);"><i class="fas fa-exchange-alt"></i> ×¤×¨×˜×™× ×¢×œ ×”×—×œ×¤×ª ××›×•×œ×”:</h4>
                    <ul>
                        <li>×”××—×™×¨ ×›×•×œ×œ ×¤×™× ×•×™ ×”××›×•×œ×” ×”××œ××” ×•×”×¦×‘×ª ××›×•×œ×” ×¨×™×§×” ×‘××§×•××”</li>
                        <li>×¤×™× ×•×™ ×”×¤×¡×•×œ×ª ××ª×‘×¦×¢ ×œ××ª×¨ ××•×¨×©×” ×‘×”×ª×× ×œ×ª×§× ×•×ª</li>
                        <li>× ×™×ª×Ÿ ×œ×”×—×œ×™×£ ×‘×™×Ÿ ×’×“×œ×™ ××›×•×œ×•×ª ×©×•× ×™× (8 ×§×•×‘ / 16 ×§×•×‘)</li>
                        <li>×™×© ×œ×”×•×“×™×¢ ×œ×¤×—×•×ª 24 ×©×¢×•×ª ××¨××© ×¢×œ ×”×¦×•×¨×š ×‘×”×—×œ×¤×”</li>
                        <li>×—.×¡×‘×Ÿ ××˜××™× ×” ×‘××ª×¨×™× ××•×¨×©×™× ×‘×œ×‘×“ ×¢×œ ×™×“×™ ×”××©×¨×“ ×œ××™×›×•×ª ×”×¡×‘×™×‘×”</li>
                    </ul>
                `, true);
                
                setTimeout(() => {
                    addBotMessage("×”×× ×ª×¨×¦×” ×œ×‘×¦×¢ ×”×–×× ×” ×œ×”×—×œ×¤×ª ××›×•×œ×”?");
                    setTimeout(() => {
                        addQuickActions([
                            '<div class="quick-action replacement-action"><i class="fas fa-shopping-cart"></i> ×”×–×× ×” ×—×“×©×”</div>',
                            '<div class="quick-action"><i class="fas fa-ruler-combined"></i> ××™×œ×• ×’×“×œ×™× ×©×œ ××›×•×œ×•×ª ×™×©?</div>',
                            '<div class="quick-action"><i class="fas fa-clipboard-list"></i> ××” ×”×ª×§× ×•×ª ×œ×”×¦×‘×ª ××›×•×œ×”?</div>'
                        ]);
                    }, 500);
                }, 1000);
            }, 1000);
        }
        
        // Handle container removal question
        function handleContainerRemovalQuestion() {
            addBotMessage("×”×•×¦××ª ××›×•×œ×” ××”××ª×¨ ×›×œ×•×œ×” ×‘××—×™×¨ ×”×”×¦×‘×” ×”××§×•×¨×™.");
            
            setTimeout(() => {
                addBotMessage(`
                    <h4 style="color: var(--removal-color);"><i class="fas fa-trash-restore"></i> ×¤×¨×˜×™× ×¢×œ ×”×•×¦××ª ××›×•×œ×”:</h4>
                    <ul>
                        <li>×¤×™× ×•×™ ×”××›×•×œ×” ××ª×‘×¦×¢ ×œ××ª×¨ ××•×¨×©×” ×‘×”×ª×× ×œ×ª×§× ×•×ª</li>
                        <li>×™×© ×œ×”×•×“×™×¢ ×œ×¤×—×•×ª 24 ×©×¢×•×ª ××¨××© ×¢×œ ×”×¦×•×¨×š ×‘×”×•×¦××”</li>
                        <li>×™×© ×œ×•×•×“× ×’×™×©×” ×—×•×¤×©×™×ª ×œ××›×•×œ×” ×‘×™×•× ×”×¤×™× ×•×™</li>
                        <li>×‘××§×¨×” ×©×œ ×”×•×¦××” ×œ×œ× ×”×¦×‘×” ××§×•×¨×™×ª ×“×¨×›× ×•, ×™×ª×›×Ÿ ×•×™×—×•×œ ×ª×©×œ×•× × ×¤×¨×“</li>
                        <li>×—.×¡×‘×Ÿ ××¡×¤×§×ª ××™×©×•×¨×™ ×”×˜×× ×” ×××ª×¨×™× ××•×¨×©×™×</li>
                    </ul>
                `, true);
                
                setTimeout(() => {
                    addBotMessage("×”×× ×ª×¨×¦×” ×œ×‘×¦×¢ ×”×–×× ×” ×œ×”×•×¦××ª ××›×•×œ×”?");
                    setTimeout(() => {
                        addQuickActions([
                            '<div class="quick-action removal-action"><i class="fas fa-shopping-cart"></i> ×”×–×× ×” ×—×“×©×”</div>',
                            '<div class="quick-action"><i class="fas fa-ruler-combined"></i> ××™×œ×• ×’×“×œ×™× ×©×œ ××›×•×œ×•×ª ×™×©?</div>',
                            '<div class="quick-action"><i class="fas fa-clipboard-list"></i> ××” ×”×ª×§× ×•×ª ×œ×”×¦×‘×ª ××›×•×œ×”?</div>'
                        ]);
                    }, 500);
                }, 1000);
            }, 1000);
        }
        
        // Handle general container question
        function handleGeneralContainerQuestion() {
            addBotMessage("×× ×—× ×• ××¦×™×¢×™× ×©×™×¨×•×ª×™ ×”×¦×‘×”, ×”×—×œ×¤×” ×•×”×•×¦××” ×©×œ ××›×•×œ×•×ª ×¤×¡×•×œ×ª ×‘× ×™×™×Ÿ.");
            
            setTimeout(() => {
                addBotMessage(`
                    <h4>×”×©×™×¨×•×ª×™× ×©×œ× ×•:</h4>
                    <ul>
                        <li><i class="fas fa-truck-loading"></i> <strong>×”×¦×‘×ª ××›×•×œ×”</strong> - ×”×¦×‘×ª ××›×•×œ×” ×—×“×©×” ×‘××ª×¨ (1200 â‚ª + ××¢"×)</li>
                        <li><i class="fas fa-exchange-alt"></i> <strong>×”×—×œ×¤×ª ××›×•×œ×”</strong> - ×”×—×œ×¤×ª ××›×•×œ×” ××œ××” ×‘×¨×™×§×” (1200 â‚ª + ××¢"×)</li>
                        <li><i class="fas fa-trash-restore"></i> <strong>×”×•×¦××ª ××›×•×œ×”</strong> - ×¤×™× ×•×™ ××›×•×œ×” ××”××ª×¨ (×›×œ×•×œ ×‘××—×™×¨ ×”×”×¦×‘×”)</li>
                    </ul>
                    <p style="margin-top: 10px;">×× ×• ××¦×™×¢×™× ××›×•×œ×•×ª ×‘×’×“×œ×™× ×©×œ 8 ×§×•×‘ ×•-16 ×§×•×‘.</p>
                `, true);
                
                setTimeout(() => {
                    addBotMessage("×”×× ×ª×¨×¦×” ××™×“×¢ × ×•×¡×£ ×¢×œ ××—×“ ××”×©×™×¨×•×ª×™× ××• ×œ×‘×¦×¢ ×”×–×× ×”?");
                    setTimeout(() => {
                        addQuickActions([
                            '×”×–×× ×” ×—×“×©×”',
                            '××™×œ×• ×’×“×œ×™× ×©×œ ××›×•×œ×•×ª ×™×©?',
                            '××” ×”×ª×§× ×•×ª ×œ×”×¦×‘×ª ××›×•×œ×”?'
                        ]);
                    }, 500);
                }, 1000);
            }, 1000);
        }
        
        // Handle disposal certification question
        function handleDisposalCertificationQuestion() {
            addBotMessage("×—.×¡×‘×Ÿ ××¡×¤×§×ª ××™×©×•×¨×™ ×”×˜×× ×” ×¨×©××™×™× (×˜×•×¤×¡ 4) ×¢×‘×•×¨ ×¤×™× ×•×™ ×¤×¡×•×œ×ª ×‘× ×™×™×Ÿ.");
            
            setTimeout(() => {
                addBotMessage(`
                    <h4>××™×©×•×¨×™ ×”×˜×× ×” (×˜×•×¤×¡ 4):</h4>
                    <ul>
                        <li>×× ×• ××˜××™× ×™× ×¤×¡×•×œ×ª ×‘× ×™×™×Ÿ ×‘××ª×¨×™× ××•×¨×©×™× ×‘×œ×‘×“ ×¢×œ ×™×“×™ ×”××©×¨×“ ×œ××™×›×•×ª ×”×¡×‘×™×‘×”</li>
                        <li>×›×œ ×¤×™× ×•×™ ××œ×•×•×” ×‘××™×©×•×¨ ×”×˜×× ×” ×¨×©××™ (×˜×•×¤×¡ 4)</li>
                        <li>×”××™×©×•×¨ × ×“×¨×© ×œ×¦×•×¨×š ×§×‘×œ×ª ×”×™×ª×¨ ××›×œ×•×¡ ××”×¢×™×¨×™×™×”</li>
                        <li>× ×™×ª×Ÿ ×œ×§×‘×œ ×¢×•×ª×§ ×“×™×’×™×˜×œ×™ ×©×œ ×”××™×©×•×¨ ×‘××™×™×œ ××• ×‘×•×•××˜×¡××¤</li>
                        <li>×”××™×©×•×¨ ×›×•×œ×œ ×¤×¨×˜×™× ×¢×œ ×›××•×ª ×”×¤×¡×•×œ×ª, ×¡×•×’×”, ×•×ª××¨×™×š ×”×¤×™× ×•×™</li>
                    </ul>
                `, true);
                
                setTimeout(() => {
                    addBotMessage("×”×× ×ª×¨×¦×” ×œ×§×‘×œ ×“×•×’××” ×©×œ ××™×©×•×¨ ×”×˜×× ×” ××• ×œ×‘×¦×¢ ×”×–×× ×”?");
                    setTimeout(() => {
                        addQuickActions([
                            '×”×–×× ×” ×—×“×©×”',
                            '×¡× ×™×¤×™× ×•×¤×¨×˜×™ ×”×ª×§×©×¨×•×ª',
                            '××” ×”×ª×§× ×•×ª ×œ×”×¦×‘×ª ××›×•×œ×”?'
                        ]);
                    }, 500);
                }, 1000);
            }, 1000);
        }
        
        // Show FAQ section
        function showFAQ() {
            let faqHTML = '<h4>×©××œ×•×ª × ×¤×•×¦×•×ª:</h4>';
            
            faqDatabase.forEach((item, index) => {
                faqHTML += `
                    <div class="faq-item">
                        <div class="faq-question">
                            ${item.question}
                            <i class="fas fa-chevron-down"></i>
                        </div>
                        <div class="faq-answer">
                            ${item.answer}
                        </div>
                    </div>
                `;
            });
            
            // Add share buttons
            faqHTML += `
                <div style="margin-top: 15px;">
                    <p>××¦× ××ª ×”×ª×©×•×‘×” ×©×—×™×¤×©×ª? ×©×ª×£ ×¢× ×—×‘×¨×™×:</p>
                    <div class="share-buttons">
                        <div class="share-button whatsapp" onclick="shareFAQ('whatsapp')">
                            WhatsApp <i class="fab fa-whatsapp"></i>
                        </div>
                        <div class="share-button facebook" onclick="shareFAQ('facebook')">
                            Facebook <i class="fab fa-facebook-f"></i>
                        </div>
                        <div class="share-button email" onclick="shareFAQ('email')">
                            Email <i class="fas fa-envelope"></i>
                        </div>
                    </div>
                </div>
            `;
            
            addBotMessage(faqHTML, false, false, false, true);
        }
        
        // Share FAQ
        function shareFAQ(platform) {
            let shareUrl = '';
            let shareText = '××¦××ª×™ ××™×“×¢ ×©×™××•×©×™ ×¢×œ ×¤×™× ×•×™ ×¤×¡×•×œ×ª ×‘× ×™×™×Ÿ:';
            
            faqDatabase.forEach(item => {
                shareText += `\n\n×©××œ×”: ${item.question}\n×ª×©×•×‘×”: ${item.question}`;
            });
            
            shareText += '\n\n×œ×§×‘×œ×ª ××™×“×¢ × ×•×¡×£, ×‘×§×¨×• ×‘××ª×¨ ×©×œ× ×•: https://www.eco-pinui.co.il';
            
            if (platform === 'whatsapp') {
                shareUrl = `https://wa.me/?text=${encodeURIComponent(shareText)}`;
            } else if (platform === 'facebook') {
                shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent('https://www.eco-pinui.co.il')}&quote=${encodeURIComponent(shareText)}`;
            } else if (platform === 'email') {
                shareUrl = `mailto:?subject=××™×“×¢ ×¢×œ ×¤×™× ×•×™ ×¤×¡×•×œ×ª ×‘× ×™×™×Ÿ&body=${encodeURIComponent(shareText)}`;
            }
            
            window.open(shareUrl, '_blank');
            
            addBotMessage("×ª×•×“×” ×¢×œ ×”×©×™×ª×•×£! ×”×× ×™×© ×¢×•×“ ××©×”×• ×©××•×›×œ ×œ×¢×–×•×¨ ×œ×š?");
        }
        
        // Handle order request
        function handleOrderRequest() {
            addBotMessage("××¦×•×™×™×Ÿ! ×× ×™ ××©××— ×œ×¢×–×•×¨ ×œ×š ×¢× ×”×–×× ×ª ××›×•×œ×” ×œ×¤×™× ×•×™ ×¤×¡×•×œ×ª ×‘× ×™×™×Ÿ.");
            
            setTimeout(() => {
                showOrderForm();
            }, 1000);
        }
        
        // Show order form
        function showOrderForm() {
            document.getElementById('order-form').style.display = 'block';
            document.getElementById('quick-actions').style.display = 'none';
            
            // Reset selected service
            selectedService = '';
            document.querySelectorAll('.branch-card').forEach(card => {
                card.style.borderLeft = 'none';
            });
            
            // Scroll to form
            setTimeout(() => {
                document.getElementById('order-form').scrollIntoView({ behavior: 'smooth' });
            }, 300);
        }
        
        // Hide order form
        function hideOrderForm() {
            document.getElementById('order-form').style.display = 'none';
            document.getElementById('quick-actions').style.display = 'flex';
        }
        
        // Update rental end date
        function updateRentalEndDate() {
            const startDateInput = document.getElementById('container-date');
            const durationInput = document.getElementById('container-duration');
            const endDateDisplay = document.getElementById('end-date-display');
            const rentalPopup = document.getElementById('rental-end-date');
            
            if (startDateInput.value) {
                const startDate = new Date(startDateInput.value);
                const duration = parseInt(durationInput.value) || 10;
                
                // Calculate end date (start date + duration days)
                const endDate = new Date(startDate);
                endDate.setDate(endDate.getDate() + duration);
                
                // Format date to DD/MM/YYYY
                const day = endDate.getDate().toString().padStart(2, '0');
                const month = (endDate.getMonth() + 1).toString().padStart(2, '0');
                const year = endDate.getFullYear();
                
                // Display end date
                endDateDisplay.textContent = `${day}/${month}/${year}`;
                rentalPopup.style.display = 'block';
                
                // Add highlight animation
                endDateDisplay.style.animation = 'none';
                setTimeout(() => {
                    endDateDisplay.style.animation = 'popupFadeIn 0.5s ease-out';
                }, 10);
                
                // Show warning if duration exceeds 10 days
                if (duration > 10) {
                    endDateDisplay.innerHTML = `<span style="color: #ff6b6b;">${day}/${month}/${year} (×—×¨×™×’×” ×-10 ×™××™×!)</span>`;
                }
            } else {
                rentalPopup.style.display = 'none';
            }
        }
        
        // Submit order
        function submitOrder() {
            const name = document.getElementById('order-name').value.trim();
            const phone = document.getElementById('order-phone').value.trim();
            const address = document.getElementById('order-address').value.trim();
            const containerSize = document.getElementById('container-size').value;
            const containerDate = document.getElementById('container-date').value;
            const containerDuration = document.getElementById('container-duration').value;
            const city = document.getElementById('city-select').value;
            const locationType = document.getElementById('location-type').value;
            const locationNotes = document.getElementById('location-notes').value.trim();
            const serviceNotes = document.getElementById('service-notes').value.trim();
            const phonePrefix = document.getElementById('phone-prefix').value;
            const sendToPhone = document.getElementById('send-to-phone').value.trim();
            
            if (!name || !phone || !address || !containerDate || !selectedService) {
                addBotMessage("× × ×œ××œ× ××ª ×›×œ ×”×©×“×•×ª ×”×“×¨×•×©×™× ×•×œ×‘×—×•×¨ ×¡×•×’ ×©×™×¨×•×ª ×œ×¤× ×™ ×©×œ×™×—×ª ×”×”×–×× ×”.");
                return;
            }
            
            // Validate phone number
            if (!/^[0-9]{7,15}$/.test(phone)) {
                addBotMessage("× × ×œ×”×–×™×Ÿ ××¡×¤×¨ ×˜×œ×¤×•×Ÿ ×ª×§×™×Ÿ (×œ×œ× ××§×¤×™× ××• ×¨×•×•×—×™×).");
                return;
            }
            
            // Store order data
            orderData = {
                name,
                phone: `${phonePrefix}${phone}`,
                address,
                containerSize,
                containerDate,
                containerDuration,
                city,
                locationType,
                locationNotes,
                serviceNotes,
                selectedService
            };
            
            // Hide form
            hideOrderForm();
            
            // Get service type text
            let serviceTypeText = '';
            if (selectedService === 'placement') {
                serviceTypeText = '×”×¦×‘×ª ××›×•×œ×”';
            } else if (selectedService === 'replacement') {
                serviceTypeText = '×”×—×œ×¤×ª ××›×•×œ×”';
            } else if (selectedService === 'removal') {
                serviceTypeText = '×”×•×¦××ª ××›×•×œ×”';
            }
            
            // Get location type text
            let locationTypeText = '';
            if (locationType === 'private') {
                locationTypeText = '×©×˜×— ×¤×¨×˜×™';
            } else if (locationType === 'public') {
                locationTypeText = '×©×˜×— ×¦×™×‘×•×¨×™ (×“×•×¨×© ×”×™×ª×¨)';
            } else if (locationType === 'parking') {
                locationTypeText = '×—× ×™×” ×¦×™×‘×•×¨×™×ª (×“×•×¨×© ×”×™×ª×¨)';
            }
            
            // Show order summary
            const orderSummary = `
                <h4>×¡×™×›×•× ×”×–×× ×”:</h4>
                <div class="order-item">
                    <span class="label">×©×:</span>
                    <span class="value">${name}</span>
                </div>
                <div class="order-item">
                    <span class="label">×˜×œ×¤×•×Ÿ:</span>
                    <span class="value">${orderData.phone}</span>
                </div>
                <div class="order-item">
                    <span class="label">×›×ª×•×‘×ª:</span>
                    <span class="value">${address}</span>
                </div>
                <div class="order-item">
                    <span class="label">×¡×•×’ ×©×™×¨×•×ª:</span>
                    <span class="value">${serviceTypeText}</span>
                </div>
                <div class="order-item">
                    <span class="label">×’×•×“×œ ××›×•×œ×”:</span>
                    <span class="value">${containerSize} ×§×•×‘</span>
                </div>
                <div class="order-item">
                    <span class="label">×ª××¨×™×š ××‘×•×§×©:</span>
                    <span class="value">${containerDate}</span>
                </div>
                <div class="order-item">
                    <span class="label">××©×š ×–××Ÿ ××©×•×¢×¨:</span>
                    <span class="value">${containerDuration} ×™××™×</span>
                </div>
                <div class="order-item">
                    <span class="label">×¢×™×¨:</span>
                    <span class="value">${city ? cityRegulations[city].title.replace('×ª×§× ×•×ª ×”×¦×‘×ª ××›×•×œ×•×ª ×‘', '') : '×œ× ×¦×•×™×Ÿ'}</span>
                </div>
                <div class="order-item">
                    <span class="label">×¡×•×’ ××™×§×•×:</span>
                    <span class="value">${locationTypeText}</span>
                </div>
            `;
            
            addBotMessage(orderSummary, true);
            
            // Add confirmation buttons
            setTimeout(() => {
                const chatMessages = document.getElementById('chat-messages');
                const buttonsDiv = document.createElement('div');
                buttonsDiv.className = 'form-actions';
                buttonsDiv.style.justifyContent = 'center';
                buttonsDiv.style.marginTop = '1rem';
                
                const confirmButton = document.createElement('button');
                confirmButton.className = 'btn btn-success';
                confirmButton.textContent = '××™×©×•×¨ ×•×©×™×œ×•×—';
                confirmButton.onclick = confirmOrder;
                
                const editButton = document.createElement('button');
                editButton.className = 'btn btn-outline';
                editButton.textContent = '×¢×¨×•×š ×”×–×× ×”';
                editButton.onclick = function() {
                    showOrderForm();
                    // Fill form with existing data
                    document.getElementById('order-name').value = orderData.name;
                    document.getElementById('order-phone').value = phone;
                    document.getElementById('order-address').value = orderData.address;
                    document.getElementById('container-size').value = orderData.containerSize;
                    document.getElementById('container-date').value = orderData.containerDate;
                    document.getElementById('container-duration').value = orderData.containerDuration;
                    document.getElementById('city-select').value = orderData.city;
                    document.getElementById('location-type').value = orderData.locationType;
                    document.getElementById('location-notes').value = orderData.locationNotes;
                    document.getElementById('service-notes').value = orderData.serviceNotes;
                    
                    // Update city regulations
                    updateCityRegulations();
                    
                    // Select service
                    selectService(orderData.selectedService);
                };
                
                buttonsDiv.appendChild(editButton);
                buttonsDiv.appendChild(confirmButton);
                chatMessages.appendChild(buttonsDiv);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }, 500);
        }
        
        // Confirm order and send via WhatsApp
        function confirmOrder() {
            // Get service type text
            let serviceTypeText = '';
            if (orderData.selectedService === 'placement') {
                serviceTypeText = '×”×¦×‘×ª ××›×•×œ×”';
            } else if (orderData.selectedService === 'replacement') {
                serviceTypeText = '×”×—×œ×¤×ª ××›×•×œ×”';
            } else if (orderData.selectedService === 'removal') {
                serviceTypeText = '×”×•×¦××ª ××›×•×œ×”';
            }
            
            // Get location type text
            let locationTypeText = '';
            if (orderData.locationType === 'private') {
                locationTypeText = '×©×˜×— ×¤×¨×˜×™';
            } else if (orderData.locationType === 'public') {
                locationTypeText = '×©×˜×— ×¦×™×‘×•×¨×™ (×“×•×¨×© ×”×™×ª×¨)';
            } else if (orderData.locationType === 'parking') {
                locationTypeText = '×—× ×™×” ×¦×™×‘×•×¨×™×ª (×“×•×¨×© ×”×™×ª×¨)';
            }
            
            // Prepare WhatsApp message
            let whatsappMessage = `×”×–×× ×” ××›×•×œ×” ×—×“×©×” :\n\n`;
            whatsappMessage += `×©×: ${orderData.name}\n`;
            whatsappMessage += `×˜×œ×¤×•×Ÿ: ${orderData.phone}\n`;
            whatsappMessage += `×›×ª×•×‘×ª: ${orderData.address}\n`;
            whatsappMessage += `×¡×•×’ ×©×™×¨×•×ª: ${serviceTypeText}\n`;
            whatsappMessage += `×’×•×“×œ ××›×•×œ×”: ${orderData.containerSize} ×§×•×‘\n`;
            whatsappMessage += `×ª××¨×™×š ××‘×•×§×©: ${orderData.containerDate}\n`;
            whatsappMessage += `××©×š ×–××Ÿ ××©×•×¢×¨: ${orderData.containerDuration} ×™××™×\n`;
            whatsappMessage += `×¢×™×¨: ${orderData.city ? cityRegulations[orderData.city].title.replace('×ª×§× ×•×ª ×”×¦×‘×ª ××›×•×œ×•×ª ×‘', '') : '×œ× ×¦×•×™×Ÿ'}\n`;
            whatsappMessage += `×¡×•×’ ××™×§×•×: ${locationTypeText}\n`;
            
            if (orderData.locationNotes) {
                whatsappMessage += `\n×”×¢×¨×•×ª ×œ××™×§×•×:\n${orderData.locationNotes}\n`;
            }
            
            if (orderData.serviceNotes) {
                whatsappMessage += `\n×”×¢×¨×•×ª × ×•×¡×¤×•×ª:\n${orderData.serviceNotes}\n`;
            }
            
            // Encode for URL
            const encodedMessage = encodeURIComponent(whatsappMessage);
            
            // Send to company WhatsApp (using a placeholder number)
            const companyWhatsappLink = `https://wa.me/972501234567?text=${encodedMessage}`;
            window.open(companyWhatsappLink, '_blank');
            
            // Send copy to customer if number provided
            const sendToPhone = document.getElementById('send-to-phone').value.trim();
            if (sendToPhone && /^[0-9]{7,15}$/.test(sendToPhone)) {
                const prefix = document.getElementById('phone-prefix').value;
                const customerWhatsappLink = `https://wa.me/${prefix}${sendToPhone}?text=${encodedMessage}`;
                setTimeout(() => {
                    window.open(customerWhatsappLink, '_blank');
                }, 1000);
            }
            
            // Show confirmation
            addBotMessage("×”×”×–×× ×” × ×©×œ×—×” ×‘×”×¦×œ×—×”! × ×¦×™×’ ×©×œ× ×• ×™×¦×•×¨ ××™×ª×š ×§×©×¨ ×‘×§×¨×•×‘ ×œ××™×©×•×¨ ×¡×•×¤×™.");
            
            // Add eco-friendly message
            setTimeout(() => {
                const randomMotivation = motivationalPhrases[Math.floor(Math.random() * motivationalPhrases.length)];
                addBotMessage(randomMotivation, false, true);
            }, 1500);
            
            // Reset order data
            orderData = {};
            
            // Add quick actions
            setTimeout(() => {
                addQuickActions([
                    '×”×–×× ×” ×—×“×©×”',
                    '×¡× ×™×¤×™× ×•×¤×¨×˜×™ ×”×ª×§×©×¨×•×ª',
                    '××” ×”×ª×§× ×•×ª ×œ×”×¦×‘×ª ××›×•×œ×”?'
                ]);
            }, 2000);
        }
        
        // Show branches information
        function showBranches() {
            addBotMessage("×œ×”×œ×Ÿ ×¤×¨×˜×™ ×”×¡× ×™×¤×™× ×©×œ× ×•:");
            
            setTimeout(() => {
                let branchesInfo = '<div class="branches">';
                
                branches.forEach(branch => {
                    branchesInfo += `
                        <div class="branch-card">
                            <h4><i class="fas fa-store"></i> ${branch.name}</h4>
                            <p>${branch.address}</p>
                            <p class="phone"><i class="fas fa-phone"></i> ${branch.phone}</p>
                            <p>×©×¢×•×ª ×¤×ª×™×—×”: ${branch.hours}</p>
                        </div>
                    `;
                });
                
                branchesInfo += '</div>';
                
                // Add order department info
                branchesInfo += `
                    <div style="margin-top: 1rem;">
                        <h4>××—×œ×§×ª ×”×–×× ×•×ª:</h4>
                        <p>××™××™×™×œ: <a href="mailto:orders@eco-pinui.co.il">orders@eco-pinui.co.il</a></p>
                        <p>××ª×¨: <a href="https://www.eco-pinui.co.il">www.eco-pinui.co.il</a></p>
                    </div>
                `;
                
                addBotMessage(branchesInfo, true);
            }, 500);
        }
        
        // Tell a joke
        function tellJoke() {
            const randomJoke = jokes[Math.floor(Math.random() * jokes.length)];
            addBotMessage(randomJoke, false, false, true);
            
            // Add motivation after joke
            setTimeout(() => {
                const randomMotivation = motivationalPhrases[Math.floor(Math.random() * motivationalPhrases.length)];
                addBotMessage(randomMotivation, false, true);
            }, 2000);
        }
        
        // Initialize 3D model (placeholder function)
        function initContainerModel(containerId, size) {
            // This would be replaced with actual Three.js code
            const container = document.getElementById(containerId);
            container.innerHTML = `
                <div style="text-align: center; padding: 20px;">
                    <i class="fas fa-cube" style="font-size: 50px; color: #666;"></i>
                    <p style="margin-top: 10px;">×”×“××™×™×ª ×ª×œ×ª ××™××“ ×©×œ ××›×•×œ×ª ${size} ×§×•×‘</p>
                    <p style="font-size: 0.8rem; color: #666;">(×‘×’×¨×¡×” ×”××œ××” ×ª×•×¦×’ ×”×“××™×” ×ª×œ×ª ××™××“×™×ª ××™× ×˜×¨××§×˜×™×‘×™×ª)</p>
                </div>
            `;
        }
    </script>
</body>
</html>
